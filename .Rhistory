qplot(Index,abs(Col0.AT3G26830), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "AT3G26830_AtCol0", colour=factor(Chrom)) +
geom_hline(yintercept=TH999_Col0.AT3G26830) +
geom_text(aes(0,TH999_Col0.AT3G26830, label = ".999 Threshold", vjust = 1.5, hjust = .05), col = "black")
#+
#  geom_hline(yintercept=TH95_Col0.Cam, colour = "blue") +
#  geom_text(aes(0,TH95_Col0.Cam, label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")
dev.off()
jpeg("plots/BcAtGWAS/AtCol0_Les.ManhattanPlot.jpg")
qplot(Index,abs(Col0.Les.s), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "Lesion_AtCol0", colour=factor(Chrom)) +
geom_hline(yintercept=TH999_Col0.Les.s) +
geom_text(aes(0,TH999_Col0.Les.s, label = ".999 Threshold", vjust = 1.5, hjust = .05), col = "black")
#+
#  geom_hline(yintercept=TH95_Col0.Cam, colour = "blue") +
#  geom_text(aes(0,TH95_Col0.Cam, label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")
dev.off()
TH99 <- HEM.thresh[3,]
TH99_Col0.Cam <- as.numeric(TH99[2])
TH99_Les.s <- as.numeric(TH99[3])
TH99_Col0.AT3G26830 <- as.numeric(TH99[4])
TH99_Col.0AT4G30530 <- as.numeric(TH99[5])
TH99_anac055.cam <- as.numeric(TH99[6])
TH99_anac055.Les.s <- as.numeric(TH99[7])
TH99_coi1.Cam <- as.numeric(TH99[8])
TH99_coi1.Les.s <- as.numeric(TH99[9])
TH99_npr1.Cam <- as.numeric(TH99[10])
TH99_npr1.Les.s <- as.numeric(TH99[11])
TH99_tga3.Cam <- as.numeric(TH99[12])
TH99_tga3.Les.s <- as.numeric(TH99[13])
TH999 <- HEM.thresh[4,]
TH999_Col0.Cam <- as.numeric(TH999[2])
TH999_Col0.Les.s <- as.numeric(TH999[3])
TH999_Col0.AT3G26830 <- as.numeric(TH999[4])
TH999_Col.0AT4G30530 <- as.numeric(TH999[5])
TH999_anac055.cam <- as.numeric(TH999[6])
TH999_anac055.Les.s <- as.numeric(TH999[7])
TH999_coi1.Cam <- as.numeric(TH999[8])
TH999_coi1.Les.s <- as.numeric(TH999[9])
TH999_npr1.Cam <- as.numeric(TH999[10])
TH999_npr1.Les.s <- as.numeric(TH999[11])
TH999_tga3.Cam <- as.numeric(TH999[12])
TH999_tga3.Les.s <- as.numeric(TH999[13])
TH95 <- HEM.thresh[1,]
TH95_Col0.Cam <- as.numeric(TH95[2])
TH95_Col0.Les.s <- as.numeric(TH95[3])
TH95_Col0.AT3G26830 <- as.numeric(TH95[4])
TH95_Col.0AT4G30530 <- as.numeric(TH95[5])
TH95_anac055.cam <- as.numeric(TH95[6])
TH95_anac055.Les.s <- as.numeric(TH95[7])
TH95_coi1.Cam <- as.numeric(TH95[8])
TH95_coi1.Les.s <- as.numeric(TH95[9])
TH95_npr1.Cam <- as.numeric(TH95[10])
TH95_npr1.Les.s <- as.numeric(TH95[11])
TH95_tga3.Cam <- as.numeric(TH95[12])
TH95_tga3.Les.s <- as.numeric(TH95[13])
TH975 <- HEM.thresh[2,]
TH975_Col0.Cam <- as.numeric(TH975[2])
TH975_Col0.Les.s <- as.numeric(TH975[3])
TH975_Col0.AT3G26830 <- as.numeric(TH975[4])
TH975_Col.0AT4G30530 <- as.numeric(TH975[5])
TH975_anac055.cam <- as.numeric(TH975[6])
TH975_anac055.Les.s <- as.numeric(TH975[7])
TH975_coi1.Cam <- as.numeric(TH975[8])
TH975_coi1.Les.s <- as.numeric(TH975[9])
TH975_npr1.Cam <- as.numeric(TH975[10])
TH975_npr1.Les.s <- as.numeric(TH975[11])
TH975_tga3.Cam <- as.numeric(TH975[12])
TH975_tga3.Les.s <- as.numeric(TH975[13])
jpeg("plots/BcAtGWAS/AtCol0_Les.ManhattanPlot.jpg")
qplot(Index,abs(Col0.Les.s), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "Lesion_AtCol0", colour=factor(Chrom)) +
geom_hline(yintercept=TH999_Col0.Les.s) +
geom_text(aes(0,TH999_Col0.Les.s, label = ".999 Threshold", vjust = 1.5, hjust = .05), col = "black")
#+
#  geom_hline(yintercept=TH95_Col0.Cam, colour = "blue") +
#  geom_text(aes(0,TH95_Col0.Cam, label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")
dev.off()
qplot(Index,abs(Col.0AT4G30530), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "AT4G30530_AtCol0", colour=factor(Chrom)) +
geom_hline(yintercept=TH999_Col.0AT4G30530) +
geom_text(aes(0,TH999_Col.0AT4G30530, label = ".999 Threshold", vjust = 1.5, hjust = .05), col = "black")
jpeg("plots/BcAtGWAS/AtCol0_AT4G30530.ManhattanPlot.jpg")
qplot(Index,abs(Col.0AT4G30530), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "AT4G30530_AtCol0", colour=factor(Chrom)) +
geom_hline(yintercept=TH999_Col.0AT4G30530) +
geom_text(aes(0,TH999_Col.0AT4G30530, label = ".999 Threshold", vjust = 1.5, hjust = .05), col = "black")
#+
#  geom_hline(yintercept=TH95_Col0.Cam, colour = "blue") +
#  geom_text(aes(0,TH95_Col0.Cam, label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")
dev.off()
qplot(Index,abs(anac055.Cam), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "anac055.Cam", colour=factor(Chrom)) +
geom_hline(yintercept=TH999_anac055.Cam) +
geom_text(aes(0,TH999_anac055.Cam, label = ".999 Threshold", vjust = 1.5, hjust = .05), col = "black")
TH999_anac055.Cam <- as.numeric(TH999[6])
TH95_anac055.Cam <- as.numeric(TH95[6])
TH975_anac055.Cam <- as.numeric(TH975[6])
qplot(Index,abs(anac055.Cam), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "anac055.Cam", colour=factor(Chrom)) +
geom_hline(yintercept=TH999_anac055.Cam) +
geom_text(aes(0,TH999_anac055.Cam, label = ".999 Threshold", vjust = 1.5, hjust = .05), col = "black")
qplot(Index,abs(anac055.Cam), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "anac055.Cam", colour=factor(Chrom)) +
geom_hline(yintercept=TH99_anac055.Cam) +
geom_text(aes(0,TH99_anac055.Cam, label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")
TH99_anac055.Cam <- as.numeric(TH99[6])
qplot(Index,abs(anac055.Cam), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "anac055.Cam", colour=factor(Chrom)) +
geom_hline(yintercept=TH99_anac055.Cam) +
geom_text(aes(0,TH99_anac055.Cam, label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")
jpeg("plots/BcAtGWAS/anac055.Cam.ManhattanPlot.jpg")
qplot(Index,abs(anac055.Cam), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "anac055.Cam", colour=factor(Chrom)) +
geom_hline(yintercept=TH99_anac055.Cam) +
geom_text(aes(0,TH99_anac055.Cam, label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black") +
geom_hline(yintercept=TH95_anac055.Cam, colour = "blue") +
geom_text(aes(0,TH95_anac055.Cam, label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")
dev.off()
qplot(Index,abs(anac055.Les.s), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "anac055.Les.s", colour=factor(Chrom)) +
geom_hline(yintercept=TH99_anac055.Les.s) +
geom_text(aes(0,TH99_anac055.Les.s, label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black") +
geom_hline(yintercept=TH95_anac055.Les.s, colour = "blue") +
geom_text(aes(0,TH95_anac055.Les.s, label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")
jpeg("plots/BcAtGWAS/anac055.Les.ManhattanPlot.jpg")
qplot(Index,abs(anac055.Les.s), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "anac055.Les.s", colour=factor(Chrom)) +
geom_hline(yintercept=TH99_anac055.Les.s) +
geom_text(aes(0,TH99_anac055.Les.s, label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black") +
geom_hline(yintercept=TH95_anac055.Les.s, colour = "blue") +
geom_text(aes(0,TH95_anac055.Les.s, label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")
dev.off()
qplot(Index,abs(Col0.AT3G26830), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "Col0.AT3G26830", colour=factor(Chrom)) +
geom_hline(yintercept=TH99_Col0.AT3G26830) +
geom_text(aes(0,TH99_Col0.AT3G26830, label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black") +
geom_hline(yintercept=TH95_Col0.AT3G26830, colour = "blue") +
geom_text(aes(0,TH95_Col0.AT3G26830, label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")
jpeg("plots/BcAtGWAS/AtCol0_AT3G26830.ManhattanPlot.jpg")
qplot(Index,abs(Col0.AT3G26830), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "Col0.AT3G26830", colour=factor(Chrom)) +
geom_hline(yintercept=TH999_Col0.AT3G26830) +
geom_text(aes(0,TH999_Col0.AT3G26830, label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")
#+
#  geom_hline(yintercept=TH95_Col0.AT3G26830, colour = "blue") +
#  geom_text(aes(0,TH95_Col0.AT3G26830, label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")
dev.off()
jpeg("plots/BcAtGWAS/AtCol0_AT3G26830_2.ManhattanPlot.jpg")
qplot(Index,abs(Col0.AT3G26830), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "Col0.AT3G26830", colour=factor(Chrom)) +
geom_hline(yintercept=TH999_Col0.AT3G26830) +
geom_text(aes(0,TH999_Col0.AT3G26830, label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")
#+
#  geom_hline(yintercept=TH95_Col0.AT3G26830, colour = "blue") +
#  geom_text(aes(0,TH95_Col0.AT3G26830, label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")
dev.off()
jpeg("plots/BcAtGWAS/AtCol0_AT3G26830_2.ManhattanPlot.jpg")
qplot(Index,abs(Col0.AT3G26830), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "Col0.AT3G26830", colour=factor(Chrom)) +
geom_hline(yintercept=TH999_Col0.AT3G26830) +
geom_text(aes(0,TH999_Col0.AT3G26830, label = ".999 Threshold", vjust = 1.5, hjust = .05), col = "black")
#+
#  geom_hline(yintercept=TH95_Col0.AT3G26830, colour = "blue") +
#  geom_text(aes(0,TH95_Col0.AT3G26830, label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")
dev.off()
qplot(Index,abs(coi1.Cam), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "coi1.Cam", colour=factor(Chrom)) +
geom_hline(yintercept=TH999_coi1.Cam) +
geom_text(aes(0,TH999_coi1.Cam, label = ".999 Threshold", vjust = 1.5, hjust = .05), col = "black")
qplot(Index,abs(coi1.Cam), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "coi1.Cam", colour=factor(Chrom)) +
geom_hline(yintercept=TH99_coi1.Cam) +
geom_text(aes(0,TH99_coi1.Cam, label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")
jpeg("plots/BcAtGWAS/coi1.Cam.ManhattanPlot.jpg")
qplot(Index,abs(coi1.Cam), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "coi1.Cam", colour=factor(Chrom)) +
geom_hline(yintercept=TH99_coi1.Cam) +
geom_text(aes(0,TH99_coi1.Cam, label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black") +
geom_hline(yintercept=TH95_coi1.Cam, colour = "blue") +
geom_text(aes(0,TH95_coi1.Cam, label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")
dev.off()
qplot(Index,abs(coi1.Les.s), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "coi1.Les.s", colour=factor(Chrom)) +
geom_hline(yintercept=TH99_coi1.Les.s) +
geom_text(aes(0,TH99_coi1.Les.s, label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")
jpeg("plots/BcAtGWAS/coi1.Les.ManhattanPlot.jpg")
qplot(Index,abs(coi1.Les.s), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "coi1.Les.s", colour=factor(Chrom)) +
geom_hline(yintercept=TH99_coi1.Les.s) +
geom_text(aes(0,TH99_coi1.Les.s, label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black") +
geom_hline(yintercept=TH95_coi1.Les.s, colour = "blue") +
geom_text(aes(0,TH95_coi1.Les.s, label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")
dev.off()
qplot(Index,abs(npr1.Cam), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "npr1.Cam", colour=factor(Chrom)) +
geom_hline(yintercept=TH99_npr1.Cam) +
geom_text(aes(0,TH99_npr1.Cam, label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")
jpeg("plots/BcAtGWAS/npr1.Cam.ManhattanPlot.jpg")
qplot(Index,abs(npr1.Cam), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "npr1.Cam", colour=factor(Chrom)) +
geom_hline(yintercept=TH99_npr1.Cam) +
geom_text(aes(0,TH99_npr1.Cam, label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black") +
geom_hline(yintercept=TH95_npr1.Cam, colour = "blue") +
geom_text(aes(0,TH95_npr1.Cam, label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")
dev.off()
qplot(Index,abs(npr1.Les.s), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "npr1.Les.s", colour=factor(Chrom)) +
geom_hline(yintercept=TH99_npr1.Les.s) +
geom_text(aes(0,TH99_npr1.Les.s, label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")
jpeg("plots/BcAtGWAS/npr1.Les.s.ManhattanPlot.jpg")
qplot(Index,abs(npr1.Les.s), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "npr1.Les.s", colour=factor(Chrom)) +
geom_hline(yintercept=TH999_npr1.Les.s) +
geom_text(aes(0,TH999_npr1.Les.s, label = ".999 Threshold", vjust = 1.5, hjust = .05), col = "black")
#+
#  geom_hline(yintercept=TH95_npr1.Les.s, colour = "blue") +
#  geom_text(aes(0,TH95_npr1.Les.s, label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")
dev.off()
qplot(Index,abs(tga3.Cam), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "tga3.Cam", colour=factor(Chrom)) +
geom_hline(yintercept=TH999_tga3.Cam) +
geom_text(aes(0,TH999_tga3.Cam, label = ".999 Threshold", vjust = 1.5, hjust = .05), col = "black")
jpeg("plots/BcAtGWAS/tga3.Cam.ManhattanPlot.jpg")
qplot(Index,abs(tga3.Cam), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "tga3.Cam", colour=factor(Chrom)) +
geom_hline(yintercept=TH999_tga3.Cam) +
geom_text(aes(0,TH999_tga3.Cam, label = ".999 Threshold", vjust = 1.5, hjust = .05), col = "black")
#+
#  geom_hline(yintercept=TH95_tga3.Cam, colour = "blue") +
#  geom_text(aes(0,TH95_tga3.Cam, label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")
dev.off()
qplot(Index,abs(tga3.Les.s), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "tga3.Les.s", colour=factor(Chrom)) +
geom_hline(yintercept=TH999_tga3.Les.s) +
geom_text(aes(0,TH999_tga3.Les.s, label = ".999 Threshold", vjust = 1.5, hjust = .05), col = "black")
jpeg("plots/BcAtGWAS/tga3.Les.s.ManhattanPlot.jpg")
qplot(Index,abs(tga3.Les.s), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "tga3.Les.s", colour=factor(Chrom)) +
geom_hline(yintercept=TH999_tga3.Les.s) +
geom_text(aes(0,TH999_tga3.Les.s, label = ".999 Threshold", vjust = 1.5, hjust = .05), col = "black")
#+
#  geom_hline(yintercept=TH95_tga3.Cam, colour = "blue") +
#  geom_text(aes(0,TH95_tga3.Cam, label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")
dev.off()
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS")
library(ggplot2)
library(grid)
HEM.plotdata <- read.csv("data/BcAtGWAS/04_bigRRoutput/At_phenos.HEM.PlotFormat.csv")
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("CeMetaDat.csv")
names(ModDat)
CeSumm <- as.data.frame(with(ModDat, table(IsolateID,Rep)))
#missing Exps: 94.1 (1), UKRazz (1), 01.04.15 (2), Gallo1 (2)
OgDat <- ModDat
ModDat <- subset(ModDat, IsolateID != c("94.1", "UKRazz", "01.04.15", "Gallo1"))
#run the model
library(lme4); library(car); library(lmerTest)
Sys.time()
sink(file='CeFullMod_060416.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|Domest/PlantGeno/IndPlant), data = ModDat)")
Sys.time()
#rand(fullmod)
Anova(fullmod, type=2)
#anova(fullmod)
Sys.time()
sink()
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|Domest/PlantGeno/IndPlant), data = ModDat)
Sys.time()
sink(file='CeFullMod_060416.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|Domest/PlantGeno/IndPlant), data = ModDat)")
Sys.time()
#rand(fullmod)
Anova(fullmod, type=2)
#anova(fullmod)
Sys.time()
sink()
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat), data = ModDat)
Sys.time()
sink(file='CeFullMod_060416.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat), data = ModDat)")
Sys.time()
#rand(fullmod)
Anova(fullmod, type=2)
#anova(fullmod)
Sys.time()
sink()
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Domest/PlantGeno/IndPlant), data = ModDat)
Sys.time()
sink(file='CeFullMod_060416b.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Domest/PlantGeno/IndPlant), data = ModDat)")
Sys.time()
#rand(fullmod)
Anova(fullmod, type=2)
#anova(fullmod)
Sys.time()
sink()
getwd()
Sys.time()
sink(file='CeFullMod_060416.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat), data = ModDat)")
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
anova(fullmod)
Sys.time()
sink()
getwd()
#-------------------------------------------------------------
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
setwd("~/Documents/GitRepos/BcEudicotGWAS/data")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("BrMetaDat.csv")
names(ModDat)
BrSumm <- as.data.frame(with(ModDat, table(IsolateID,Rep)))
#missing Exps: 01.05.22 (1), 02.04.21 (1), Geranium (2), Navel (2)
OgDat <- ModDat
ModDat <- subset(ModDat, IsolateID != c("01.05.22","02.04.21","Geranium","Navel"))
#run the model
library(lme4); library(car); library(lmerTest)
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|IndPlant), data = ModDat)
getwd()
Anova(fullmod, type=2)
CiSumm <- as.data.frame(with(ModDat, table(IsolateID,Rep)))
View(CiSumm)
CiSumm <- as.data.frame(with(ModDat, table(IsolateID,Exp)))
ModDat <- subset(ModDat, IsolateID != c("01.05.22","02.04.21","Geranium","Navel"))
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("HaMetaDat.csv")
names(ModDat)
library(lme4); library(car); library(lmerTest)
HaSumm <- as.data.frame(with(ModDat, table(IsolateID,Exp)))
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("HaMetaDat.csv")
names(ModDat)
HaSumm <- as.data.frame(with(ModDat, table(IsolateID,Exp)))
OgDat <- ModDat
View(HaSumm)
ModDat <- subset(ModDat, IsolateID != c("1.05.04","KGB1"))
OgDat <- ModDat
ModDat <- subset(ModDat, IsolateID != c("1.05.04","KGB1"))
unique(ModDat$IsolateID)
ModDat <- subset(ModDat, IsolateID != c("1.05.04","KGB1"))
ModDat <- subset(ModDat, IsolateID != c("KGB1"))
ModDat <- subset(ModDat, IsolateID != c("1.05.04"))
View(ModDat)
unique(ModDat$IsolateID)
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("CiMetaDat.csv")
names(ModDat)
CiSumm <- as.data.frame(with(ModDat, table(IsolateID,Exp)))
#missing Exps: 2.04.21 (1), 1.05.22 (1), Geranium (2), Navel (2)
OgDat <- ModDat
ModDat <- subset(ModDat, IsolateID != c("01.05.22","02.04.21","Geranium","Navel"))
#run the model
library(lme4); library(car); library(lmerTest)
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|Domest/PlantGeno/IndPlant), data = ModDat)
Sys.time()
sink(file='CiFullMod_060516.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|Domest/PlantGeno/IndPlant), data = ModDat)")
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
Sys.time()
#removed flat
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Domest/PlantGeno/IndPlant), data = ModDat)
Sys.time()
sink(file='CiFullMod_060516.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Domest/PlantGeno/IndPlant), data = ModDat)")
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
anova(fullmod)
Sys.time()
sink()
Sys.time()
#removed indplant
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat), data = ModDat)
Sys.time()
sink(file='CiFullMod_060516b.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat), data = ModDat)")
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
anova(fullmod)
Sys.time()
sink()
attach(ModDat)
out <- split( ModDat , f = ModDat$PlantGeno)
head(out[[1]]) #100 elements, max. 69 obs per isolate
sink(file="CiLSMeans060616.txt")
for (i in c(1:12)) {
print(unique(out[[i]]$PlantGeno))
#this one works
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp) + (1|Exp/Rep), data=out[[i]])
Lesion.lsm <- lsmeans(Lesion.lm, "IsolateID")
print(Lesion.lsm)
}
sink()
sink(file="CiLSMeans060616.txt")
for (i in c(1:12)) {
print(unique(out[[i]]$PlantGeno))
#this one works
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp) + (1|IndPlant), data=out[[i]])
Lesion.lsm <- lsmeans(Lesion.lm, "IsolateID")
print(Lesion.lsm)
}
sink()
getwd()
sink(file="output/ModelOutputs/CiLSMeans_060616.txt")
print("Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp), data=out[[i]])")
for (i in c(1:12)) {
print(unique(out[[i]]$PlantGeno))
#this one works
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp), data=out[[i]])
Lesion.lsm <- lsmeans(Lesion.lm, "IsolateID")
print(Lesion.lsm)
}
sink()
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
setwd("~/Documents/GitRepos/BcEudicotGWAS/data")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("BrMetaDat.csv")
names(ModDat)
BrSumm <- as.data.frame(with(ModDat, table(IsolateID,Rep)))
#missing Exps: 01.05.22 (1), 02.04.21 (1), Geranium (2), Navel (2)
OgDat <- ModDat
ModDat <- subset(ModDat, IsolateID != c("01.05.22","02.04.21","Geranium","Navel"))
#run the model
library(lme4); library(car); library(lmerTest)
getwd()
setwd("~/Projects/BcEudicotGWAS/")
ModDat <- read.csv("data/MetaAnalysis/BrMetaDat.csv")
names(ModDat)
BrSumm <- as.data.frame(with(ModDat, table(IsolateID,Rep)))
#missing Exps: 01.05.22 (1), 02.04.21 (1), Geranium (2), Navel (2)
OgDat <- ModDat
ModDat <- subset(ModDat, IsolateID != c("01.05.22","02.04.21","Geranium","Navel"))
#run the model
library(lme4); library(car); library(lmerTest)
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|Domest/PlantGeno/IndPlant), data = ModDat)
Sys.time()
sink(file='output/ModelOutputs/BrFullMod_060616.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|Domest/PlantGeno/IndPlant), data = ModDat)")
Sys.time()
rand(fullmod)
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("data/MetaAnalysis/HaMetaDat.csv")
names(ModDat)
HaSumm <- as.data.frame(with(ModDat, table(IsolateID,Exp)))
#missing Exps: 1.05.04 (1), KGB1 (2)
OgDat <- ModDat
#do separately due to error
ModDat <- subset(ModDat, IsolateID != ("1.05.04"))
ModDat <- subset(ModDat, IsolateID != ("KGB1"))
#run the model
library(lme4); library(car); library(lmerTest)
Sys.time()
#working model
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|Domest/PlantGeno/IndPlant), data = ModDat)
Sys.time()
sink(file='output/ModelOutputs/HcFullMod_060716.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|Domest/PlantGeno/IndPlant), data = ModDat)")
Sys.time()
rand(fullmod)
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat), data = ModDat)
Sys.time()
sink(file='output/ModelOutputs/HcFullMod_060716a.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat), data = ModDat)")
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
anova(fullmod)
Sys.time()
sink()
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Domest/PlantGeno/IndPlant), data = ModDat)
Sys.time()
sink(file='output/ModelOutputs/HcFullMod_060716b.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) +  (1|Domest/PlantGeno/IndPlant), data = ModDat)")
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
anova(fullmod)
Sys.time()
sink()
