setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
SlModDat <- read.csv("SlModelData.csv")
BrModDat <- read.csv("BrModelData.csv")
CeModDat <- read.csv("CeModelData.csv")
CiModDat <- read.csv("CiModelData.csv")
GmModDat <- read.csv("GmModelData.csv")
HcModDat <- read.csv("HcModelData.csv")
names(SlModDat)
names(BrModDat)
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
Files <- list.files(pattern=".csv")
Files
for(i in 1:1) { #1:length(Files)
MyData <- read.csv(Files[i])
}
for(i in 1:1) { #1:length(Files)
MyData <- read.csv(Files[i])
names(MyData)
}
names(MyData)
for(i in 1:1) { #1:length(Files)
MyData <- read.csv(Files[i])
print(names(MyData))
}
SlModDat <- read.csv("SlModelData.csv")
BrModDat <- read.csv("BrModelData.csv")
CeModDat <- read.csv("CeModelData.csv")
CiModDat <- read.csv("CiModelData.csv")
GmModDat <- read.csv("GmModelData.csv")
HcModDat <- read.csv("HcModelData.csv")
names(SlModDat)
names(BrModDat)
head(BrModDat)
library(plyr)
head(SlModDat)
SlModDat2 <- dplyr::select(SlModDat, Exp = ExpBlock, Rep = PExpRep.x, Flat = AgFlat, Domest = Species, PlantGeno = PlGenoNm, IndPlant = IndPlant, IsolateID = Igeno, Scale.LS = Scale.LS)
View(SlModDat2)
SlModDat <- dplyr::select(SlModDat, Exp = ExpBlock, Rep = PExpRep.x, Flat = AgFlat, Domest = Species, PlantGeno = PlGenoNm, IndPlant = IndPlant, IsolateID = Igeno, Scale.LS = Scale.LS)
names(BrModDat)
head(BrModDat)
BrModDat <- dplyr::select(BrModDat, Exp = Exp, Rep = Rep, Flat = ImageName, Domest = Domestication, PlantGeno = PlantID, IndPlant = PnumID, IsolateID = IsolateID, Scale.LS = Scale.LS)
head(CeModDat)
CeModDat <- dplyr::select(CeModDat, Exp = Exp, Rep = Rep, Flat = ImageName, Domest = Domestication, PlantGeno = PlantID, IndPlant = PnumID, IsolateID = IsolateID, Scale.LS = Scale.LS)
head(CeModDat)
head(CiModDat)
CiModDat <- dplyr::select(CiModDat, Exp = Exp, Rep = Rep, Flat = ImageName, Domest = Domestication, PlantGeno = PlantID, IndPlant = PnumID, IsolateID = IsolateID, Scale.LS = Scale.LS)
head(GmModDat)
GmModDat <- dplyr::select(GmModDat, Exp = exp, Rep = rep, Flat = Image, Domest = origin, PlantGeno = genotypename, IndPlant = plantnumber, IsolateID = isolatename, Scale.LS = Scale.LS)
head(HcModDat)
HcModDat <- dplyr::select(HcModDat, Exp = Exp, Rep = Rep, Flat = ImageName, Domest = Domestication, PlantGeno = PlantID, IndPlant = PnumID, IsolateID = IsolateID, Scale.LS = Scale.LS)
write.csv(SlModDat, "SlMetaDat.csv")
write.csv(BrModDat, "BrMetaDat.csv")
write.csv(CeModDat, "CeMetaDat.csv")
write.csv(CiModDat, "CiMetaDat.csv")
write.csv(GmModDat, "GmMetaDat.csv")
write.csv(HcModDat, "HcMetaDat.csv")
Files <- list.files(pattern=".csv")
Files <- list.files(pattern="MetaDat.csv")
Files
for(i in 1:1) { #1:length(Files)
MyData <- read.csv(Files[i])
print(names(MyData))
}
rbind(SlModDat, BrModDat)
FullMetaDat <- rbind(SlModDat, BrModDat, CeModDat)
FullMetaDat <- rbind(SlModDat, BrModDat, CeModDat, CiModDat, GmModDat, HcModDat)
FullMetaDat <- rbind(SlModDat, BrModDat, CeModDat, CiModDat)
FullMetaDat <- rbind(SlModDat, BrModDat, CeModDat, CiModDat, GmModDat)
View(GmModDat)
View(HcModDat)
FullMetaDat <- rbind(SlModDat, BrModDat, CeModDat, CiModDat, HcModDat)
FullMetaDat <- rbind(SlModDat, BrModDat, CeModDat, CiModDat, HcModDat, GmModDat)
View(FullMetaDat)
View(GmModDat)
GmModDat$IndPlant <- as.factor(GmModDat$IndPlant)
FullMetaDat <- rbind(SlModDat, BrModDat, CeModDat, CiModDat, HcModDat, GmModDat)
SlModDat$Taxon <- Solanum
SlModDat$Taxon <- "Solanum"
BrModDat$Taxon <- "Brapa"
CeModDat$Taxon <- "Cendivia"
CiModDat$Taxon <- "Cintybus"
GmModDat$Taxon <- "Glycine"
HcModDat$Taxon <- "Helianthus"
write.csv(SlModDat, "SlMetaDat.csv")
write.csv(BrModDat, "BrMetaDat.csv")
write.csv(CeModDat, "CeMetaDat.csv")
write.csv(CiModDat, "CiMetaDat.csv")
write.csv(GmModDat, "GmMetaDat.csv")
write.csv(HcModDat, "HcMetaDat.csv")
FullMetaDat <- rbind(SlModDat, BrModDat, CeModDat, CiModDat, HcModDat, GmModDat)
write.csv(FullMetaDat, "FULLMetaDat.csv")
MyData <- read.csv("FULLMetaDat.csv")
View(MyData)
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
#-------------------------------------------------------------
MyData <- read.csv("FULLMetaDat.csv")
names(MyData)
attach(MyData)
MyData$avgLS <- ave(MyData$Scale.LS, MyData$IsolateID)
View(MyData)
FigDat <- ddply(MyData, c("PlantGeno", "IsolateID", "Domest", "avgLS"), summarise,
mLS   = mean(Scale.LS))
library(dplyr)
FigDat <- ddply(MyData, c("PlantGeno", "IsolateID", "Domest", "avgLS"), summarise,
mLS   = mean(Scale.LS))
FigDat <- ddply(MyData, c("PlantGeno", "IsolateID", "Domest", "avgLS"), summarise,
mLS   = mean(Scale.LS))
library(dplyr)
FigDat <- ddply(MyData, c("PlantGeno", "IsolateID", "Domest", "avgLS"), summarise,
mLS   = mean(Scale.LS))
??ddply
library(plyr)
FigDat <- ddply(MyData, c("PlantGeno", "IsolateID", "Domest", "avgLS"), summarise,
mLS   = mean(Scale.LS))
MDmeans <- ddply(MyData, c("PlantGeno","Domest"), summarise, mean=mean(Scale.LS))
MDmeans <- MDmeans[order(MDmeans$Domest, MDmeans$mean),]
View(MDmeans)
MDmeans <- ddply(MyData, c("PlantGeno","Domest", "Taxon"), summarise, mean=mean(Scale.LS))
MDmeans <- MDmeans[order(MDmeans$Taxon, MDmeans$Domest, MDmeans$mean),]
View(MDmeans)
View(MDmeans)
View(MDmeans)
View(FigDat)
View(MDmeans)
MDmeans$PlNum <- c(1,2,3,4,5,6,1,2,3,4,5,6,1,2,3,4,5,6,1,2,3,4,5,6,1,2,3,4,5,6,1,2,3,4,5,6,1,2,3,4,5,6,1,2,3,4,5,6,1,2,3,4,5,6,1,2,3,4,5,6,1,2,3,4,5,6,1,2,3,4,5,6)
View(MDmeans)
FigDat <- merge(FigDat, MDmeans, by="PlantGeno")
View(FigDat)
FigDat <- dplyr::select(FigDat, PlOrder = mean, matches("."))
FigDat$PlOrder <- as.numeric(FigDat3$PlOrder)
FigDat$PlOrder <- as.numeric(FigDat$PlOrder)
library(ggplot2)
attach(FigDat)
names(FigDat)
unique(FigDat$Species)
unique(FigDat$Species.x)
unique(FigDat$Domest.x)
View(FigDat)
FigDat <- ddply(MyData, c("PlantGeno", "IsolateID", "Domest", "avgLS"), summarise,
mLS   = mean(Scale.LS))
View(MDmeans)
FigDat <- merge(FigDat, MDmeans[,c(1,3:5)], by="PlantGeno")
FigDat <- dplyr::select(FigDat, PlOrder = mean, matches("."))
FigDat$PlOrder <- as.numeric(FigDat$PlOrder)
attach(FigDat)
names(FigDat)
FigDat$Domest[FigDat$Domest == 'D'] <- 'Domesticated'
FigDat$Domest[FigDat$Domest == 'Dm'] <- 'Domesticated'
FigDat$Domest[FigDat$Domest == 'W'] <- 'Wild'
FigDat$Domest[FigDat$Domest == 'Wl'] <- 'Wild'
unique(FigDat$Domest)
FigDat$mmLS <- ave(FigDat$mLS, FigDat$IsolateID)
attach(FigDat)
FigDat <- FigDat[order(mmLS),]
names(FigDat)
ggplot(FigDat, aes(x = PlOrder, y = mLS))+
geom_point()
ggplot(FigDat, aes(x = PlOrder, y = mLS))+
geom_point()+
theme_bw()
ggplot(FigDat, aes(x = PlOrder, y = mLS))+
geom_point()+
theme_bw()+
geom_line(size=1, aes(color=factor(mmLS), group=factor(IsolateID)), show.legend=F)
ggplot(FigDat, aes(x = PlNum, y = mLS))+
geom_point()+
theme_bw()+
geom_line(size=1, aes(color=factor(mmLS), group=factor(IsolateID)), show.legend=F)
ggplot(FigDat, aes(x = PlNum, y = mLS))+
geom_point()+
theme_bw()+
geom_line(size=1, aes(color=factor(mmLS), group=factor(IsolateID)), show.legend=F)+
#scale_x_discrete(breaks=c("1","2","3", "4", "5", "6", "1", "2", "3", "4", "5", "6"),
#labels=c("LA4345", "LA3008", "LA4355", "LA2706", "LA3475", "LA0410", "LA1547", "LA2093", "LA1684", "LA1589", "LA0480", "LA2176"))+
facet_grid(~Domest, scales="fixed", space="free_x")
ggplot(FigDat, aes(x = PlNum, y = mLS))+
geom_point()+
theme_bw()+
geom_line(size=1, aes(color=factor(mmLS), group=factor(IsolateID)), show.legend=F)+
#scale_x_discrete(breaks=c("1","2","3", "4", "5", "6", "1", "2", "3", "4", "5", "6"),
#labels=c("LA4345", "LA3008", "LA4355", "LA2706", "LA3475", "LA0410", "LA1547", "LA2093", "LA1684", "LA1589", "LA0480", "LA2176"))+
facet_grid(~Domest*Taxon, scales="fixed", space="free_x")
ggplot(FigDat, aes(x = PlNum, y = mLS))+
geom_point()+
theme_bw()+
geom_line(size=1, aes(color=factor(mmLS), group=factor(IsolateID)), show.legend=F)+
#scale_x_discrete(breaks=c("1","2","3", "4", "5", "6", "1", "2", "3", "4", "5", "6"),
#labels=c("LA4345", "LA3008", "LA4355", "LA2706", "LA3475", "LA0410", "LA1547", "LA2093", "LA1684", "LA1589", "LA0480", "LA2176"))+
facet_grid(~Taxon*Domest, scales="fixed", space="free_x")
j
asdf
#add TxMean to scale lesion size by taxon
MDmeans$TxMean <- ave(MDmeans$Scale.LS, MDmeans$Taxon)
MDmeans$TxMean <- ave(MDmeans$mean, MDmeans$Taxon)
MDmeans <- MDmeans[order(MDmeans$Taxon, MDmeans$Domest, MDmeans$mean),]
MDmeans$PlNum <- c(1,2,3,4,5,6,1,2,3,4,5,6,1,2,3,4,5,6,1,2,3,4,5,6,1,2,3,4,5,6,1,2,3,4,5,6,1,2,3,4,5,6,1,2,3,4,5,6,1,2,3,4,5,6,1,2,3,4,5,6,1,2,3,4,5,6,1,2,3,4,5,6)
FigDat <- merge(FigDat, MDmeans[,c(1,3:5)], by="PlantGeno")
FigDat <- merge(FigDat, MDmeans[,c(1,3:6)], by="PlantGeno")
View(FigDat)
View(MDmeans)
View(MDmeans)
FigDat <- merge(FigDat, MDmeans[,c(1,4:6)], by="PlantGeno")
FigDat <- ddply(MyData, c("PlantGeno", "IsolateID", "Domest", "avgLS"), summarise,
mLS   = mean(Scale.LS))
FigDat <- merge(FigDat, MDmeans[,c(1,4:6)], by="PlantGeno")
View(FigDat)
FigDat <- dplyr::select(FigDat, PlOrder = mean, matches("."))
FigDat$PlOrder <- as.numeric(FigDat$PlOrder)
FigDat$mLS <- (FigDat$mLS / FigDat$TxMean)
FigDat$mmLS <- ave(FigDat$mLS, FigDat$IsolateID)
attach(FigDat)
FigDat <- FigDat[order(mmLS),]
ggplot(FigDat, aes(x = PlNum, y = mLS))+
geom_point()+
theme_bw()+
geom_line(size=1, aes(color=factor(mmLS), group=factor(IsolateID)), show.legend=F)+
#scale_x_discrete(breaks=c("1","2","3", "4", "5", "6", "1", "2", "3", "4", "5", "6"),
#labels=c("LA4345", "LA3008", "LA4355", "LA2706", "LA3475", "LA0410", "LA1547", "LA2093", "LA1684", "LA1589", "LA0480", "LA2176"))+
facet_grid(~Taxon*Domest, scales="fixed", space="free_x")
ggplot(FigDat, aes(x = PlNum, y = mLS))+
geom_point()+
theme_bw()
ggplot(FigDat, aes(x = PlNum, y = mLS))+
geom_point()+
theme_bw()+
geom_line(size=1, aes(color=factor(mmLS), group=factor(IsolateID)), show.legend=F)
ggplot(FigDat, aes(x = PlNum, y = mLS))+
geom_point()+
theme_bw()+
geom_line(size=1, aes(color=factor(mmLS), group=factor(IsolateID)), show.legend=F)+
#scale_x_discrete(breaks=c("1","2","3", "4", "5", "6", "1", "2", "3", "4", "5", "6"),
#labels=c("LA4345", "LA3008", "LA4355", "LA2706", "LA3475", "LA0410", "LA1547", "LA2093", "LA1684", "LA1589", "LA0480", "LA2176"))+
facet_grid(~Taxon*Domest, scales="fixed", space="free_x")
attach(FigDat)
FigDat <- FigDat[order(mmLS),]
ggplot(FigDat, aes(x = PlNum, y = mLS))+
geom_point()+
theme_bw()+
geom_line(size=1, aes(color=factor(mmLS), group=factor(IsolateID)), show.legend=F)+
#scale_x_discrete(breaks=c("1","2","3", "4", "5", "6", "1", "2", "3", "4", "5", "6"),
#labels=c("LA4345", "LA3008", "LA4355", "LA2706", "LA3475", "LA0410", "LA1547", "LA2093", "LA1684", "LA1589", "LA0480", "LA2176"))+
facet_grid(~Taxon*Domest, scales="fixed", space="free_x")
names(FigDat)
View(MDmeans)
View(FigDat)
FigDat <- ddply(MyData, c("PlantGeno", "IsolateID", "Domest", "Taxon", "avgLS"), summarise,
mLS   = mean(Scale.LS))
View(FigDat)
FigDat <- merge(FigDat, MDmeans[,c(1,4:6)], by="PlantGeno")
View(FigDat)
FigDat <- dplyr::select(FigDat, PlOrder = mean, matches("."))
FigDat$PlOrder <- as.numeric(FigDat$PlOrder)
FigDat$Domest[FigDat$Domest == 'D'] <- 'Domesticated'
FigDat$Domest[FigDat$Domest == 'Dm'] <- 'Domesticated'
FigDat$Domest[FigDat$Domest == 'W'] <- 'Wild'
FigDat$Domest[FigDat$Domest == 'Wl'] <- 'Wild'
FigDat$mLS <- (FigDat$mLS / FigDat$TxMean)
FigDat$mmLS <- ave(FigDat$mLS, FigDat$IsolateID)
attach(FigDat)
FigDat <- FigDat[order(mmLS),]
ggplot(FigDat, aes(x = PlNum, y = mLS))+
geom_point()+
theme_bw()
FigDat <- FigDat[order(mmLS),]
ggplot(FigDat, aes(x = PlNum, y = mLS))+
geom_point()+
theme_bw()+
geom_line(size=1, aes(color=factor(mmLS), group=factor(IsolateID)), show.legend=F)+
#scale_x_discrete(breaks=c("1","2","3", "4", "5", "6", "1", "2", "3", "4", "5", "6"),
#labels=c("LA4345", "LA3008", "LA4355", "LA2706", "LA3475", "LA0410", "LA1547", "LA2093", "LA1684", "LA1589", "LA0480", "LA2176"))+
facet_grid(~Taxon*Domest, scales="fixed", space="free_x")
attach(MyData)
p <- ggplot(MyData, aes(factor(Taxon), Scale.LS))
p + geom_violin()
p + geom_violin(trim=F)
p <- ggplot(MyData, aes(factor(Taxon), Scale.LS))
p + geom_violin(trim=T)
p + geom_violin(trim=T, aes(fill = Domest))
names(MyData)
MyData$Domest[MyData$Domest == 'D'] <- 'Domesticated'
MyData$Domest[MyData$Domest == 'Dm'] <- 'Domesticated'
MyData$Domest[MyData$Domest == 'W'] <- 'Wild'
MyData$Domest[MyData$Domest == 'Wl'] <- 'Wild'
p <- ggplot(MyData, aes(factor(Taxon), Scale.LS))
p + geom_violin(trim=T, aes(fill = Domest))
p + geom_violin(trim=T, aes(fill = Domest)) +
ylim(0,6)
p + geom_violin(trim=T, aes(fill = Domest)) +
ylim(0,5)
p + geom_violin(trim=T, aes(fill = Domest)) +
ylim(0,5) +
stat_summary(fun.y=mean, geom="point", shape=23, size=2)
p <- ggplot(MyData, aes(factor(Taxon,Domest), Scale.LS))
p
p <- ggplot(MyData, aes(factor(Taxon*Domest), Scale.LS))
p
p + geom_violin(trim=T, aes(fill = Domest)) +
stat_summary(fun.y=mean, geom="point", shape=23, size=2)+
ylim(0,5)
p <- ggplot(MyData, aes(factor(Taxon), Scale.LS))
p + geom_violin(trim=T, aes(fill = Domest)) +
stat_summary(fun.y=mean, geom="point", shape=23, size=2)+
ylim(0,5)
p + geom_violin(trim=T, aes(fill = Domest)) +
+ geom_boxplot(width=0.1)
ylim(0,5)
p + geom_violin(trim=T) + #, aes(fill = Domest)
+ geom_boxplot(width=0.1)
ylim(0,5)
p + geom_violin(trim=T) + #, aes(fill = Domest)
geom_boxplot(width=0.1) +
ylim(0,5)
p + geom_violin((trim=T), aes(fill = Domest))
p + geom_violin(trim=T), aes(fill = Domest))
p <- ggplot(MyData, aes(factor(Taxon), Scale.LS))
p + geom_violin(trim=T), aes(fill = Domest))
p + geom_violin(trim=T, aes(fill = Domest))
p + geom_violin(trim=T, aes(fill = Domest))
geom_boxplot(width=0.1, aes(fill=Domest)) +
ylim(0,5)
p + geom_violin(trim=T, aes(fill = Domest))
geom_boxplot(width=0.1, aes(colour=Domest))
p <- ggplot(MyData, aes(factor(Taxon), Domest, Scale.LS))
p
p <- ggplot(MyData, aes(factor(Taxon), Domest), Scale.LS))
p <- ggplot(MyData, aes(factor(Taxon), Scale.LS))
p
p + geom_violin(trim=T, aes(fill = Domest))+
geom_boxplot(width=0.1, aes(colour=Domest))
p + geom_boxplot(width=0.1, aes(colour=Domest))
p + geom_violin(trim=T, aes(fill = Domest))+
ylim(0,5)
p + geom_violin(trim=T, aes(fill = Domest))+
ylim(0,5) +
labs( x = NA, y = Scaled Lesion Size)
p + geom_violin(trim=T, aes(fill = Domest))+
ylim(0,5) +
labs( x = element_blank(), y = "Scaled Lesion Size")
p + geom_violin(trim=T, aes(fill = Domest))+
ylim(0,5) +
theme( axis.title.x = element_blank(), axis.title.y = "Scaled Lesion Size")
p + geom_violin(trim=T, aes(fill = Domest))+
ylim(0,5) +
theme( axis.title.x = element_blank()) +
ylab("Scaled Lesion Size")
p <- ggplot(MyData, aes(factor(Taxon), Scale.LS, fill=Domest))
p + geom_violin(trim=T)
p + geom_violin(trim=T)+
ylim(0,5) +
theme( axis.title.x = element_blank())
p + geom_violin(trim=T)+
ylim(0,5) +
theme( axis.title.x = element_blank()) +
ylab("Scaled Lesion Size")+
geom_boxplot(width=0.1)
p + geom_violin(trim=T)+
ylim(0,5) +
theme( axis.title.x = element_blank()) +
ylab("Scaled Lesion Size")+
geom_boxplot(width=0.2)
p + geom_violin(trim=T)+
ylim(0,5) +
theme( axis.title.x = element_blank()) +
ylab("Scaled Lesion Size")+
geom_boxplot(width=0.2)+
position = position_dodge(width = 1.5)
p + geom_violin(trim=T)+
ylim(0,5) +
theme( axis.title.x = element_blank()) +
ylab("Scaled Lesion Size")+
geom_boxplot(width=0.2)+
position = position_dodge(width = 1.5)
p + geom_violin(trim=T)+
ylim(0,5) +
theme( axis.title.x = element_blank()) +
ylab("Scaled Lesion Size")+
geom_boxplot(width=0.2, position = position_dodge(width = 1.5))
p + geom_violin(trim=T)+
ylim(0,5) +
theme( axis.title.x = element_blank()) +
ylab("Scaled Lesion Size")+
geom_boxplot(width=0.2, position = position_dodge(width = 1))
p + geom_violin(trim=T)+
ylim(0,5) +
theme( axis.title.x = element_blank()) +
ylab("Scaled Lesion Size")+
geom_boxplot(width=0.2, position = position_dodge(width = 0.9))
p + geom_violin(trim=T)+
ylim(0,5) +
theme( axis.title.x = element_blank()) +
ylab("Scaled Lesion Size")+
geom_boxplot(width=0.1, position = position_dodge(width = 0.9))
p + geom_violin(trim=T, scale="count")
p <- ggplot(MyData, aes(factor(Taxon), Scale.LS, fill=Domest))
p + geom_violin(trim=T, scale="equal")
p + geom_violin(trim=T, scale="equal")
p + geom_violin(trim=T, scale="count")
p + geom_violin(trim=T, scale=2)
p + geom_violin(trim=T, scale=4)
p + geom_violin(trim=T)+
ylim(0,5) +
theme( axis.title.x = element_blank()) +
ylab("Scaled Lesion Size")+
geom_boxplot(width=0.1, position = position_dodge(width = 0.9))
beanplot(Scale.LS ~ Taxon, data=MyData, las=3)
library("beanplot")
beanplot(Scale.LS ~ Taxon, data=MyData, las=3)
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
#-------------------------------------------------------------
#first get all data frames to match up
SlModDat <- read.csv("SlModelData.csv")
BrModDat <- read.csv("BrModelData.csv")
CeModDat <- read.csv("CeModelData.csv")
CiModDat <- read.csv("CiModelData.csv")
GmModDat <- read.csv("GmModelData.csv")
HcModDat <- read.csv("HcModelData.csv")
library(plyr)
#format: new = old
SlModDat <- dplyr::select(SlModDat, Exp = ExpBlock, Rep = PExpRep.x, Flat = AgFlat, Domest = Species, PlantGeno = PlGenoNm, IndPlant = IndPlant, IsolateID = Igeno, Scale.LS = Scale.LS, matches("."))
SlModDat$Taxon <- "Solanum"
BrModDat <- dplyr::select(BrModDat, Exp = Exp, Rep = Rep, Flat = ImageName, Domest = Domestication, PlantGeno = PlantID, IndPlant = PnumID, IsolateID = IsolateID, Scale.LS = Scale.LS, matches("."))
BrModDat$Taxon <- "Brapa"
CeModDat <- dplyr::select(CeModDat, Exp = Exp, Rep = Rep, Flat = ImageName, Domest = Domestication, PlantGeno = PlantID, IndPlant = PnumID, IsolateID = IsolateID, Scale.LS = Scale.LS, matches("."))
CeModDat$Taxon <- "Cendivia"
CiModDat <- dplyr::select(CiModDat, Exp = Exp, Rep = Rep, Flat = ImageName, Domest = Domestication, PlantGeno = PlantID, IndPlant = PnumID, IsolateID = IsolateID, Scale.LS = Scale.LS, matches("."))
CiModDat$Taxon <- "Cintybus"
GmModDat <- dplyr::select(GmModDat, Exp = exp, Rep = rep, Flat = Image, Domest = origin, PlantGeno = genotypename, IndPlant = plantnumber, IsolateID = isolatename, Scale.LS = Scale.LS, matches("."))
GmModDat$Taxon <- "Glycine"
GmModDat$IndPlant <- as.factor(GmModDat$IndPlant)
HcModDat <- dplyr::select(HcModDat, Exp = Exp, Rep = Rep, Flat = ImageName, Domest = Domestication, PlantGeno = PlantID, IndPlant = PnumID, IsolateID = IsolateID, Scale.LS = Scale.LS, matches("."))
HcModDat$Taxon <- "Helianthus"
BrModDat$IsolateID <- revalue(BrModDat$IsolateID, c("FresaS.D." = "FresaSD", "Katietomato" = "KatieTomato", "Mex-03" = "Mex03", "NobelRot" = "NobleRot", "Peppersub" = "PepperSub", "Tripple3(T3)" = "Triple3", "Tripple7(T7)" = "Triple7", "UKrazz" = "UKRazz"))
CeModDat$IsolateID <- revalue(CeModDat$IsolateID, c("FresaS.D." = "FresaSD", "Katietomato" = "KatieTomato", "Mex-03" = "Mex03", "NobelRot" = "NobleRot", "Peppersub" = "PepperSub", "Tripple3(T3)" = "Triple3", "Tripple7(T7)" = "Triple7", "UKrazz" = "UKRazz"))
CiModDat$IsolateID <- revalue(CiModDat$IsolateID, c("FresaS.D." = "FresaSD", "Katietomato" = "KatieTomato", "Mex-03" = "Mex03", "NobelRot" = "NobleRot", "Peppersub" = "PepperSub", "Tripple3(T3)" = "Triple3", "Tripple7(T7)" = "Triple7", "UKrazz" = "UKRazz"))
HcModDat$IsolateID <- revalue(HcModDat$IsolateID, c("FresaS.D." = "FresaSD", "Katietomato" = "KatieTomato", "Mex-03" = "Mex03", "NobelRot" = "NobleRot", "Peppersub" = "PepperSub", "Tripple3(T3)" = "Triple3", "Tripple7(T7)" = "Triple7", "UKrazz" = "UKRazz"))
GmModDat$IsolateID <- revalue(GmModDat$IsolateID, c("1.01.6" = "1.01.06", "FresaS.D." = "FresaSD", "Peppersub" = "PepperSub", "Triple3(T3)" = "Triple3", "Triple7(T7)" = "Triple7", "UKrazz" = "UKRazz"))
write.csv(SlModDat, "SlMetaDat.csv")
write.csv(BrModDat, "BrMetaDat.csv")
write.csv(CeModDat, "CeMetaDat.csv")
write.csv(CiModDat, "CiMetaDat.csv")
write.csv(GmModDat, "GmMetaDat.csv")
write.csv(HcModDat, "HcMetaDat.csv")
FullMetaDat <- rbind(SlModDat, BrModDat, CeModDat, CiModDat, HcModDat, GmModDat)
names(BrModDat)
ModDat$Scale.LS.t <- ModDat$Scale.LS + 1
ModDat <- read.csv("BrMetaDat.csv")
names(ModDat)
ModDat$Scale.LS.t <- ModDat$Scale.LS + 1
qqp(ModDat$Scale.LS.t, "norm")
require(MASS)
qqp(ModDat$Scale.LS.t, "norm")
require(car)
qqp(ModDat$Scale.LS.t, "norm")
qqp(ModDat$Scale.LS.t, "lnorm")
ModDat$Scale.LS.i <- ModDat$Scale.LS*100 + 100
ModDat$Scale.LS.i <- round(ModDat$Scale.LS.i)
nbinom <- fitdistr(ModDat$Scale.LS.i, "Negative Binomial")
qqp(ModDat$Scale.LS.i, "nbinom", size = nbinom$estimate[[1]], mu = nbinom$estimate[[2]])
poisson <- fitdistr(ModDat$Scale.LS.i, "Poisson")
qqp(ModDat$Scale.LS.i, "pois", poisson$estimate)
names(ModDat)
Sys.time()
sink(file='BrFullMod_040816.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|IndPlant), data = ModDat)")
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|IndPlant), data = ModDat)
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
anova(fullmod)
Sys.time()
sink()
library(lme4)
Sys.time()
sink(file='BrFullMod_040816.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|IndPlant), data = ModDat)")
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|IndPlant), data = ModDat)
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
anova(fullmod)
Sys.time()
sink()
?rand
??rand
library(car); library(lmerTest)
rand(fullmod)
rand(fullmod)
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat), data = ModDat)
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
anova(fullmod)
Sys.time()
sink()
sink(file='BrFullMod_041016.txt')
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
anova(fullmod)
Sys.time()
sink()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep), data = ModDat)
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp), data = ModDat)
sink(file='BrFullMod_041116.txt')
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
anova(fullmod)
Sys.time()
sink()
