for (i in c(1:12)) {
print(unique(out[[i]]$PlantGeno))
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp) + (1|Exp/Rep) + (1|IndPlant), data=out[[i]])
Lesion.lsm <- lsmeans(Lesion.lm, "IsolateID")
print(Lesion.lsm)
}
for (i in c(1:12)) {
print(unique(out[[i]]$PlantGeno))
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp) + (1|Exp/Rep), data=out[[i]])
Lesion.lsm <- lsmeans(Lesion.lm, "IsolateID")
print(Lesion.lsm)
}
sink(file="LSMeans041116.txt")
for (i in c(1:12)) {
print(unique(out[[i]]$PlantGeno))
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp) + (1|Exp/Rep), data=out[[i]])
Lesion.lsm <- lsmeans(Lesion.lm, "IsolateID")
print(Lesion.lsm)
}
sink()
for (i in c(1:12)) {
print(unique(out[[i]]$PlantGeno))
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp), data=out[[i]])
Lesion.lsm <- lsmeans(Lesion.lm, "IsolateID")
print(Lesion.lsm)
}
sink(file="LSMeans041116.txt")
for (i in c(1:12)) {
print(unique(out[[i]]$PlantGeno))
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp), data=out[[i]])
Lesion.lsm <- lsmeans(Lesion.lm, "IsolateID")
print(Lesion.lsm)
}
sink()
#modeling for Cichorium endivia
#041116
#-------------------------------------------------------------
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("CeMetaDat.csv")
names(ModDat)
library(lme4); library(car); library(lmerTest)
Sys.time()
Sys.time()
sink(file='CeFullMod_041116.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|IndPlant), data = ModDat)")
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|IndPlant), data = ModDat)
sink()
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|IndPlant), data = ModDat)
sink(file='CeFullMod_041116.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|IndPlant), data = ModDat)")
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
anova(fullmod)
Sys.time()
sink()
attach(ModDat)
out <- split( ModDat , f = ModDat$PlantGeno)
head(out[[1]]) #100 elements, max. 69 obs per isolate
for (i in c(1:12)) {
print(unique(out[[i]]$PlantGeno))
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp) + (1|Exp/Rep) + (1|IndPlant), data=out[[i]])
Lesion.lsm <- lsmeans(Lesion.lm, "IsolateID")
print(Lesion.lsm)
k
ikfd
l
''
)
for (i in c(1:12)) {
print(unique(out[[i]]$PlantGeno))
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp) + (1|Exp/Rep) + (1|IndPlant), data=out[[i]])
Lesion.lsm <- lsmeans(Lesion.lm, "IsolateID")
print(Lesion.lsm)
}
for (i in c(1:12)) {
print(unique(out[[i]]$PlantGeno))
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp) + (1|IndPlant), data=out[[i]])
Lesion.lsm <- lsmeans(Lesion.lm, "IsolateID")
print(Lesion.lsm)
}
for (i in c(1:12)) {
print(unique(out[[i]]$PlantGeno))
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp) + (1|Exp/Rep), data=out[[i]])
Lesion.lsm <- lsmeans(Lesion.lm, "IsolateID")
print(Lesion.lsm)
}
sink(file="CeLSMeans041216.txt")
for (i in c(1:12)) {
print(unique(out[[i]]$PlantGeno))
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp) + (1|IndPlant), data=out[[i]])
Lesion.lsm <- lsmeans(Lesion.lm, "IsolateID")
print(Lesion.lsm)
}
sink()
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
ModDat <- read.csv("CiMetaDat.csv")
names(ModDat)
library(lme4); library(car); library(lmerTest)
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("CeMetaDat.csv")
names(ModDat)
library(lme4); library(car); library(lmerTest)
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Domest/PlantGeno/IndPlant), data = ModDat)
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("CiMetaDat.csv")
names(ModDat)
library(lme4); library(car); library(lmerTest)
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|Domest/PlantGeno/IndPlant), data = ModDat)
Sys.time()
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Domest/PlantGeno/IndPlant), data = ModDat)
Sys.time()
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep), data = ModDat)
Sys.time()
sink(file='CiFullMod_041216.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep), data = ModDat)")
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
anova(fullmod)
Sys.time()
sink()
attach(ModDat)
out <- split( ModDat , f = ModDat$PlantGeno)
head(out[[1]]) #100 elements, max. 69 obs per isolate
sink(file="CiLSMeans041216.txt")
for (i in c(1:12)) {
print(unique(out[[i]]$PlantGeno))
#this one works
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp) + (1|Exp/Rep), data=out[[i]])
Lesion.lsm <- lsmeans(Lesion.lm, "IsolateID")
print(Lesion.lsm)
}
sink()
sink(file="CiLSMeans041216.txt")
for (i in c(1:12)) {
print(unique(out[[i]]$PlantGeno))
#this one works
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp), data=out[[i]])
Lesion.lsm <- lsmeans(Lesion.lm, "IsolateID")
print(Lesion.lsm)
}
sink()
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("GmMetaDat.csv")
names(ModDat)
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("GmMetaDat.csv")
names(ModDat)
library(lme4); library(car); library(lmerTest)
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|Domest/PlantGeno/IndPlant), data = ModDat)
Sys.time()
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Domest/PlantGeno/IndPlant), data = ModDat)
Sys.time()
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Domest/PlantGeno/IndPlant), data = ModDat)
Sys.time()
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) , data = ModDat)
Sys.time()
sink(file='GmFullMod_041216.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) , data = ModDat)")
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
anova(fullmod)
Sys.time()
sink()
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp) + (1|Exp/Rep) + (1|IndPlant), data=out[[i]])
out <- split( ModDat , f = ModDat$PlantGeno)
head(out[[1]]) #100 elements, max. 69 obs per isolate
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp) + (1|Exp/Rep) + (1|IndPlant), data=out[[i]])
for (i in c(1:12)) {
print(unique(out[[i]]$PlantGeno))
#this one works
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp) + (1|Exp/Rep) + (1|IndPlant), data=out[[i]])
Lesion.lsm <- lsmeans(Lesion.lm, "IsolateID")
print(Lesion.lsm)
}
sink(file="GmLSMeans041216.txt")
for (i in c(1:12)) {
print(unique(out[[i]]$PlantGeno))
#this one works
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp) + (1|Exp/Rep) + (1|IndPlant), data=out[[i]])
Lesion.lsm <- lsmeans(Lesion.lm, "IsolateID")
print(Lesion.lsm)
}
sink()
sink(file="GmLSMeans041316.txt")
for (i in c(1:12)) {
print(unique(out[[i]]$PlantGeno))
#this one works
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp) + (1|IndPlant), data=out[[i]])
Lesion.lsm <- lsmeans(Lesion.lm, "IsolateID")
print(Lesion.lsm)
}
sink()
for (i in c(1:12)) {
print(unique(out[[i]]$PlantGeno))
#this one works
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp) + (1|IndPlant), data=out[[i]])
Lesion.lsm <- lsmeans(Lesion.lm, "IsolateID")
print(Lesion.lsm)
}
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("GmMetaDat.csv")
ModDat <- read.csv("HaMetaDat.csv")
ModDat <- read.csv("HcMetaDat.csv")
library(lme4); library(car); library(lmerTest)
names(ModDat)
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|Domest/PlantGeno/IndPlant), data = ModDat)
Sys.time()
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("GmMetaDat.csv")
names(ModDat)
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("HcMetaDat.csv")
names(ModDat)
library(lme4); library(car); library(lmerTest)
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Domest/PlantGeno/IndPlant), data = ModDat)
Sys.time()
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Domest/PlantGeno/IndPlant), data = ModDat)
Sys.time()
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep), data = ModDat)
Sys.time()
sink(file='HcFullMod_041316.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep), data = ModDat)")
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
anova(fullmod)
Sys.time()
sink()
Sys.time()
#working model
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp), data = ModDat)
Sys.time()
sink(file='HcFullMod_041316.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp), data = ModDat)")
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
anova(fullmod)
Sys.time()
sink()
attach(ModDat)
out <- split( ModDat , f = ModDat$PlantGeno)
head(out[[1]])
for (i in c(1:12)) {
print(unique(out[[i]]$PlantGeno))
#this one works
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp) + (1|Exp/Rep) + (1|IndPlant), data=out[[i]])
Lesion.lsm <- lsmeans(Lesion.lm, "IsolateID")
print(Lesion.lsm)
}
for (i in c(1:12)) {
print(unique(out[[i]]$PlantGeno))
#this one works
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp) + (1|IndPlant), data=out[[i]])
Lesion.lsm <- lsmeans(Lesion.lm, "IsolateID")
print(Lesion.lsm)
}
sink(file="HcLSMeans041316.txt")
for (i in c(1:12)) {
print(unique(out[[i]]$PlantGeno))
#this one works
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp) + (1|IndPlant), data=out[[i]])
Lesion.lsm <- lsmeans(Lesion.lm, "IsolateID")
print(Lesion.lsm)
}
sink()
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data")
#load data
ModDat <- read.csv("SlMetaDat.csv")
#-------------------------------------------------------------
#rename to match other data
names(ModDat)
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
ModDat <- read.csv("SlMetaDat.csv")
names(ModDat)
ModDatC <- read.csv("CiMetaDat.csv")
names(ModDatC)
library(lme4); library(car); library(lmerTest)
attach(ModDat)
out <- split( ModDat , f = ModDat$PlantGeno)
head(out[[1]]) #100 elements, max. 69 obs per isolate
#Using a for loop, iterate over the list of data frames in out[[]]
#original one from BcSolGWAS:
#Lesion.lm <- lmer(Scale.LS ~ Igeno + Plant/Leaf/AorB + (1|Exp), data=out[[i]])
sink(file="SlLSMeans041816.txt")
for (i in c(1:12)) {
print(unique(out[[i]]$PlantGeno))
Lesion.lm <- lmer(Scale.LS ~ IsolateID + IndPlant/Leaf/AorB + (1|Exp), data=out[[i]])
Lesion.lsm <- lsmeans(Lesion.lm, "IsolateID")
print(Lesion.lsm)
}
sink()
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
#load data
ModDat <- read.csv("SlMetaDat.csv")
library(lme4); library(car); library(lmerTest)
Sys.time()
#this model worked in my original BcSolGWAS analysis
#fullmod <- lmer(Scale.LS ~ Igeno + Species/PlGenoNm + Igeno:Species/PlGenoNm + Igeno:Species + ExpBlock + (1|ExpBlock/AgFlat) + (1|IndPlant) + AorB , data = ModDat)
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep/Flat), + (1|Exp/Rep) + (1|Species/PlGenoNm/IndPlant) + (1|Species/PlGenoNm/IndPlant/AorB), data = ModDat)
sink(file='SlFullMod_041816_01.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep/Flat), + (1|Exp/Rep) + (1|Species/PlGenoNm/IndPlant) + (1|Species/PlGenoNm/IndPlant/AorB), data = ModDat)")
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
anova(fullmod)
Sys.time()
sink()
#run another
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep/Flat), + (1|Exp/Rep) + (1|Species/PlGenoNm/IndPlant), data = ModDat)
sink(file='SlFullMod_041816_02.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep/Flat), + (1|Exp/Rep) + (1|Species/PlGenoNm/IndPlant), data = ModDat)")
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
anova(fullmod)
Sys.time()
sink()
names(ModDat)
library(lme4)
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep/Flat), + (1|Exp/Rep) + (1|Species/PlGenoNm/IndPlant) + (1|Species/PlGenoNm/IndPlant/AorB), data = ModDat)
View(ModDat)
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep/Flat), + (1|Exp/Rep), data = ModDat)
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
#load data
ModDat <- read.csv("SlMetaDat.csv")
#run the model
library(lme4); library(car); library(lmerTest)
Sys.time()
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
#load data
ModDat <- read.csv("SlMetaDat.csv")
library(lme4);
Sys.time()
names(ModDat)
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp), data = ModDat)
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep/Flat), + (1|Exp/Rep) + (1|Species/PlGenoNm/IndPlant) + (1|Species/PlGenoNm/IndPlant/AorB), data = ModDat)
Sys.time()
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep/Flat), + (1|Exp/Rep) + (1|Species/PlGenoNm/IndPlant), data = ModDat)
Sys.time()
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep/Flat), + (1|Exp/Rep), data = ModDat)
Sys.time()
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp)+ (1|Exp/Rep), data = ModDat)
Sys.time()
sink(file='SlFullMod_041916_01.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep/Flat), + (1|Exp/Rep), data = ModDat)")
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
anova(fullmod)
Sys.time()
sink()
library(lme4); library(car); library(lmerTest)
sink(file='SlFullMod_041916_01.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep/Flat), + (1|Exp/Rep), data = ModDat)")
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
anova(fullmod)
Sys.time()
sink()
setwd("~/Documents/GitRepos/BcEudicotGWAS/data")
setwd("~/Documents/GitRepos/BcEudicotGWAS/data")
rm(list=ls())
setwd("~/Documents/GitRepos/BcEudicotGWAS/data")
ModDat <- read.csv("BrMetaDat.csv")
library(lme4); library(car); library(lmerTest)
install.packages("lme4")
library(lme4); library(car); library(lmerTest)
install.packages("car")
library(lmerTest)
install.packages("lmerTest")
install.packages("plyr")
library(plyr)
install.packages('ggplot2',dependencies = TRUE)
install.packages(c('reshape2','scales'))
install.packages('ggplot2',dependencies = TRUE)
install.packages(c('reshape2','scales'))
library(reshape2)
library(lmerTest)
install.packages("lmerTest")
install.packages("lmerTest")
library(car)
install.packages("car")
library(car)
library(lmerTest)
library(lme4)
library(lme4); library(car); library(lmerTest)
BrSumm <- as.data.frame(with(ModDat, table(IsolateID,Rep)))
OgDat <- ModDat
ModDat <- subset(ModDat, IsolateID != c("01.05.22","02.04.21","Geranium","Navel"))
Sys.time()
sink(file='BrFullMod_042716.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|IndPlant), data = ModDat)")
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|IndPlant), data = ModDat)
#this one does not give p values
#dropping 1|IndPlant and 1|Exp/Rep/Flat and 1|Exp/Rep doesn't fix it either.
#working model
#do get p-vals, BrFullMod_041116.txt
##fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp), data = ModDat)
##sink(file='BrFullMod_041116b.txt')
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
anova(fullmod)
Sys.time()
sink()
setwd("~/Documents/GitRepos/BcEudicotGWAS/data")
rm(list=ls())
setwd("~/Documents/GitRepos/BcEudicotGWAS/data")
SNPs <- read.csv("SNP_files/hp_binaryMAF20.csv", row.names = 1)
SNPs_rename <- SNPs
SNPnames <- read.csv("Key_SNPnames.csv")
SNPnames <- read.csv("SNP_files/Key_SNPnames.csv")
SNPnames <- SNPnames[c(2,5)]
Phenos <- read.csv("GmModelDataDT2.csv")
#read in model data with 2 trays dropped
names( SNPs_rename ) <- SNPnames[ match( names( SNPs_rename ) , SNPnames[ , 'SNPname' ] ) ,'GenoRename' ]
Phenos$isolatename <- revalue(Phenos$isolatename, c("1.01.6" = "1.01.06", "FresaS.D." = "FresaSD", "Peppersub" = "PepperSub", "Triple3(T3)" = "Triple3", "Triple7(T7)" = "Triple7", "UKrazz" = "UKRazz"))
library(plyr)
Phenos$isolatename <- revalue(Phenos$isolatename, c("1.01.6" = "1.01.06", "FresaS.D." = "FresaSD", "Peppersub" = "PepperSub", "Triple3(T3)" = "Triple3", "Triple7(T7)" = "Triple7", "UKrazz" = "UKRazz"))
View(Phenos)
unique(Phenos$isolatename)
unique(SNPnames$GenoRename)
Phenos$isolatename <- revalue(Phenos$isolatename, c("MEA P6G" = "MEAP6G", "Kern A2" = "KernA2", "Pepper sub" = "PepperSub", "Fresa 525" = "Fresa525", "Gallo 2" = "Gallo2", "Apple 404" = "Apple404", "Fresa S.D." = "FresaSD", "BPA 1" = "BPA1", "Noble Rot" = "NobleRot", "Katie Tomato" = "KatieTomato", "Davis Navel" = "DavisNavel", "Apple 517" = "Apple517", "Kern B2" = "KernB2", "Triple 3 (T3)" = "Triple3", "Philo Menlo" = "PhiloMenlo", "Kern B1" = "KernB1", "Triple 7 (T7)" = "Triple7", "Esparato Fresa" = "EsparatoFresa", "UK razz" = "UKRazz", "Gallo 1" = "Gallo1")
)
unique(Phenos$isolatename)
unique(Phenos$isolatename)
Phenos$isolatename <- revalue(Phenos$isolatename, c("UK razz" = "UKRazz"))
Phenos$isolatename <- revalue(Phenos$isolatename, c("UK razz " = "UKRazz"))
unique(Phenos$isolatename)
df1 <- unique(Phenos$isolatename)
df2 <- unique(SNPnames$GenoRename)
write.csv(df1, "delete1.csv")
write.csv(df2, "delete2.csv")
Phenos$isolatename <- revalue(Phenos$isolatename, c("MEA P6G" = "MEAP6G", "Kern A2" = "KernA2", "Pepper sub" = "PepperSub", "Fresa 525" = "Fresa525", "Gallo 2" = "Gallo2", "Apple 404" = "Apple404", "Fresa S.D." = "FresaSD", "BPA 1" = "BPA1", "Noble Rot" = "NobleRot", "Katie Tomato" = "KatieTomato", "Davis Navel" = "DavisNavel", "Apple 517" = "Apple517", "Kern B2" = "KernB2", "Triple 3 (T3)" = "T3", "Philo Menlo" = "PhiloMenlo", "Kern B1" = "KernB1", "Triple 7 (T7)" = "T7", "Esparato Fresa" = "EsparatoFresa", "UK razz " = "UKRazz", "Gallo 1" = "Gallo1"))
Phenos <- read.csv("GmModelDataDT2.csv")
Phenos$isolatename <- revalue(Phenos$isolatename, c("MEA P6G" = "MEAP6G", "Kern A2" = "KernA2", "Pepper sub" = "PepperSub", "Fresa 525" = "Fresa525", "Gallo 2" = "Gallo2", "Apple 404" = "Apple404", "Fresa S.D." = "FresaSD", "BPA 1" = "BPA1", "Noble Rot" = "NobleRot", "Katie Tomato" = "KatieTomato", "Davis Navel" = "DavisNavel", "Apple 517" = "Apple517", "Kern B2" = "KernB2", "Triple 3 (T3)" = "T3", "Philo Menlo" = "PhiloMenlo", "Kern B1" = "KernB1", "Triple 7 (T7)" = "T7", "Esparato Fresa" = "EsparatoFresa", "UK razz " = "UKRazz", "Gallo 1" = "Gallo1"))
SNPMt <- as.data.frame(names(SNPs_rename))
PhenoMatch <- Phenos
PhenoMatch <- PhenoMatch[PhenoMatch$Igeno %in% SNPMt$"names(SNPs_rename)", ]
View(SNPMt)
PhenoMatch <- Phenos
PhenoMatch <- PhenoMatch[PhenoMatch$isolatename %in% SNPMt$"names(SNPs_rename)", ]
View(PhenoMatch)
View(PhenoMatch)
PhenoMt <- as.data.frame(PhenoMatch[,14])
View(PhenoMt)
SNPMatch <- SNPs_rename
View(SNPs_rename)
SNPs3 <- SNPs_rename[,c(1:3)]
View(PhenoMt)
names(PhenoMt)
View(SNPMatch)
SNPMatch <- SNPMatch[names(SNPMatch) %in% (PhenoMt$"PhenoMatch[, 14]")]
SNPMatch <- SNPMatch[ , order(names(SNPMatch))]
SNPMatch2 <- cbind(SNPs3,SNPMatch)
View(SNPMatch)
View(SNPMatch2)
View(SNPMatch2)
PhenoMatch2 <- PhenoMatch[order(PhenoMatch$isolatename),]
View(PhenoMatch2)
