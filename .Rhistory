qplot(Index,abs(coi1.Cam), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "coi1.Cam", colour=factor(Chrom)) +
geom_hline(yintercept=TH99_coi1.Cam) +
geom_text(aes(0,TH99_coi1.Cam, label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black") +
geom_hline(yintercept=TH95_coi1.Cam, colour = "blue") +
geom_text(aes(0,TH95_coi1.Cam, label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")
dev.off()
qplot(Index,abs(coi1.Les.s), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "coi1.Les.s", colour=factor(Chrom)) +
geom_hline(yintercept=TH99_coi1.Les.s) +
geom_text(aes(0,TH99_coi1.Les.s, label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")
jpeg("plots/BcAtGWAS/coi1.Les.ManhattanPlot.jpg")
qplot(Index,abs(coi1.Les.s), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "coi1.Les.s", colour=factor(Chrom)) +
geom_hline(yintercept=TH99_coi1.Les.s) +
geom_text(aes(0,TH99_coi1.Les.s, label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black") +
geom_hline(yintercept=TH95_coi1.Les.s, colour = "blue") +
geom_text(aes(0,TH95_coi1.Les.s, label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")
dev.off()
qplot(Index,abs(npr1.Cam), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "npr1.Cam", colour=factor(Chrom)) +
geom_hline(yintercept=TH99_npr1.Cam) +
geom_text(aes(0,TH99_npr1.Cam, label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")
jpeg("plots/BcAtGWAS/npr1.Cam.ManhattanPlot.jpg")
qplot(Index,abs(npr1.Cam), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "npr1.Cam", colour=factor(Chrom)) +
geom_hline(yintercept=TH99_npr1.Cam) +
geom_text(aes(0,TH99_npr1.Cam, label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black") +
geom_hline(yintercept=TH95_npr1.Cam, colour = "blue") +
geom_text(aes(0,TH95_npr1.Cam, label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")
dev.off()
qplot(Index,abs(npr1.Les.s), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "npr1.Les.s", colour=factor(Chrom)) +
geom_hline(yintercept=TH99_npr1.Les.s) +
geom_text(aes(0,TH99_npr1.Les.s, label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")
jpeg("plots/BcAtGWAS/npr1.Les.s.ManhattanPlot.jpg")
qplot(Index,abs(npr1.Les.s), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "npr1.Les.s", colour=factor(Chrom)) +
geom_hline(yintercept=TH999_npr1.Les.s) +
geom_text(aes(0,TH999_npr1.Les.s, label = ".999 Threshold", vjust = 1.5, hjust = .05), col = "black")
#+
#  geom_hline(yintercept=TH95_npr1.Les.s, colour = "blue") +
#  geom_text(aes(0,TH95_npr1.Les.s, label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")
dev.off()
qplot(Index,abs(tga3.Cam), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "tga3.Cam", colour=factor(Chrom)) +
geom_hline(yintercept=TH999_tga3.Cam) +
geom_text(aes(0,TH999_tga3.Cam, label = ".999 Threshold", vjust = 1.5, hjust = .05), col = "black")
jpeg("plots/BcAtGWAS/tga3.Cam.ManhattanPlot.jpg")
qplot(Index,abs(tga3.Cam), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "tga3.Cam", colour=factor(Chrom)) +
geom_hline(yintercept=TH999_tga3.Cam) +
geom_text(aes(0,TH999_tga3.Cam, label = ".999 Threshold", vjust = 1.5, hjust = .05), col = "black")
#+
#  geom_hline(yintercept=TH95_tga3.Cam, colour = "blue") +
#  geom_text(aes(0,TH95_tga3.Cam, label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")
dev.off()
qplot(Index,abs(tga3.Les.s), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "tga3.Les.s", colour=factor(Chrom)) +
geom_hline(yintercept=TH999_tga3.Les.s) +
geom_text(aes(0,TH999_tga3.Les.s, label = ".999 Threshold", vjust = 1.5, hjust = .05), col = "black")
jpeg("plots/BcAtGWAS/tga3.Les.s.ManhattanPlot.jpg")
qplot(Index,abs(tga3.Les.s), data=HEM.plotdata, ylab="SNP Effect Estimate" ,
main = "tga3.Les.s", colour=factor(Chrom)) +
geom_hline(yintercept=TH999_tga3.Les.s) +
geom_text(aes(0,TH999_tga3.Les.s, label = ".999 Threshold", vjust = 1.5, hjust = .05), col = "black")
#+
#  geom_hline(yintercept=TH95_tga3.Cam, colour = "blue") +
#  geom_text(aes(0,TH95_tga3.Cam, label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")
dev.off()
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS")
library(ggplot2)
library(grid)
HEM.plotdata <- read.csv("data/BcAtGWAS/04_bigRRoutput/At_phenos.HEM.PlotFormat.csv")
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("CeMetaDat.csv")
names(ModDat)
CeSumm <- as.data.frame(with(ModDat, table(IsolateID,Rep)))
#missing Exps: 94.1 (1), UKRazz (1), 01.04.15 (2), Gallo1 (2)
OgDat <- ModDat
ModDat <- subset(ModDat, IsolateID != c("94.1", "UKRazz", "01.04.15", "Gallo1"))
#run the model
library(lme4); library(car); library(lmerTest)
Sys.time()
sink(file='CeFullMod_060416.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|Domest/PlantGeno/IndPlant), data = ModDat)")
Sys.time()
#rand(fullmod)
Anova(fullmod, type=2)
#anova(fullmod)
Sys.time()
sink()
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|Domest/PlantGeno/IndPlant), data = ModDat)
Sys.time()
sink(file='CeFullMod_060416.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|Domest/PlantGeno/IndPlant), data = ModDat)")
Sys.time()
#rand(fullmod)
Anova(fullmod, type=2)
#anova(fullmod)
Sys.time()
sink()
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat), data = ModDat)
Sys.time()
sink(file='CeFullMod_060416.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat), data = ModDat)")
Sys.time()
#rand(fullmod)
Anova(fullmod, type=2)
#anova(fullmod)
Sys.time()
sink()
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Domest/PlantGeno/IndPlant), data = ModDat)
Sys.time()
sink(file='CeFullMod_060416b.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Domest/PlantGeno/IndPlant), data = ModDat)")
Sys.time()
#rand(fullmod)
Anova(fullmod, type=2)
#anova(fullmod)
Sys.time()
sink()
getwd()
Sys.time()
sink(file='CeFullMod_060416.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat), data = ModDat)")
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
anova(fullmod)
Sys.time()
sink()
getwd()
#-------------------------------------------------------------
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
setwd("~/Documents/GitRepos/BcEudicotGWAS/data")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("BrMetaDat.csv")
names(ModDat)
BrSumm <- as.data.frame(with(ModDat, table(IsolateID,Rep)))
#missing Exps: 01.05.22 (1), 02.04.21 (1), Geranium (2), Navel (2)
OgDat <- ModDat
ModDat <- subset(ModDat, IsolateID != c("01.05.22","02.04.21","Geranium","Navel"))
#run the model
library(lme4); library(car); library(lmerTest)
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|IndPlant), data = ModDat)
getwd()
Anova(fullmod, type=2)
CiSumm <- as.data.frame(with(ModDat, table(IsolateID,Rep)))
View(CiSumm)
CiSumm <- as.data.frame(with(ModDat, table(IsolateID,Exp)))
ModDat <- subset(ModDat, IsolateID != c("01.05.22","02.04.21","Geranium","Navel"))
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("HaMetaDat.csv")
names(ModDat)
library(lme4); library(car); library(lmerTest)
HaSumm <- as.data.frame(with(ModDat, table(IsolateID,Exp)))
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("HaMetaDat.csv")
names(ModDat)
HaSumm <- as.data.frame(with(ModDat, table(IsolateID,Exp)))
OgDat <- ModDat
View(HaSumm)
ModDat <- subset(ModDat, IsolateID != c("1.05.04","KGB1"))
OgDat <- ModDat
ModDat <- subset(ModDat, IsolateID != c("1.05.04","KGB1"))
unique(ModDat$IsolateID)
ModDat <- subset(ModDat, IsolateID != c("1.05.04","KGB1"))
ModDat <- subset(ModDat, IsolateID != c("KGB1"))
ModDat <- subset(ModDat, IsolateID != c("1.05.04"))
View(ModDat)
unique(ModDat$IsolateID)
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("CiMetaDat.csv")
names(ModDat)
CiSumm <- as.data.frame(with(ModDat, table(IsolateID,Exp)))
#missing Exps: 2.04.21 (1), 1.05.22 (1), Geranium (2), Navel (2)
OgDat <- ModDat
ModDat <- subset(ModDat, IsolateID != c("01.05.22","02.04.21","Geranium","Navel"))
#run the model
library(lme4); library(car); library(lmerTest)
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|Domest/PlantGeno/IndPlant), data = ModDat)
Sys.time()
sink(file='CiFullMod_060516.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|Domest/PlantGeno/IndPlant), data = ModDat)")
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
Sys.time()
#removed flat
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Domest/PlantGeno/IndPlant), data = ModDat)
Sys.time()
sink(file='CiFullMod_060516.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Domest/PlantGeno/IndPlant), data = ModDat)")
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
anova(fullmod)
Sys.time()
sink()
Sys.time()
#removed indplant
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat), data = ModDat)
Sys.time()
sink(file='CiFullMod_060516b.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat), data = ModDat)")
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
anova(fullmod)
Sys.time()
sink()
attach(ModDat)
out <- split( ModDat , f = ModDat$PlantGeno)
head(out[[1]]) #100 elements, max. 69 obs per isolate
sink(file="CiLSMeans060616.txt")
for (i in c(1:12)) {
print(unique(out[[i]]$PlantGeno))
#this one works
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp) + (1|Exp/Rep), data=out[[i]])
Lesion.lsm <- lsmeans(Lesion.lm, "IsolateID")
print(Lesion.lsm)
}
sink()
sink(file="CiLSMeans060616.txt")
for (i in c(1:12)) {
print(unique(out[[i]]$PlantGeno))
#this one works
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp) + (1|IndPlant), data=out[[i]])
Lesion.lsm <- lsmeans(Lesion.lm, "IsolateID")
print(Lesion.lsm)
}
sink()
getwd()
sink(file="output/ModelOutputs/CiLSMeans_060616.txt")
print("Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp), data=out[[i]])")
for (i in c(1:12)) {
print(unique(out[[i]]$PlantGeno))
#this one works
Lesion.lm <- lmer(Scale.LS ~ IsolateID + (1|Exp), data=out[[i]])
Lesion.lsm <- lsmeans(Lesion.lm, "IsolateID")
print(Lesion.lsm)
}
sink()
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/MetaAnalysis")
setwd("~/Documents/GitRepos/BcEudicotGWAS/data")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("BrMetaDat.csv")
names(ModDat)
BrSumm <- as.data.frame(with(ModDat, table(IsolateID,Rep)))
#missing Exps: 01.05.22 (1), 02.04.21 (1), Geranium (2), Navel (2)
OgDat <- ModDat
ModDat <- subset(ModDat, IsolateID != c("01.05.22","02.04.21","Geranium","Navel"))
#run the model
library(lme4); library(car); library(lmerTest)
getwd()
setwd("~/Projects/BcEudicotGWAS/")
ModDat <- read.csv("data/MetaAnalysis/BrMetaDat.csv")
names(ModDat)
BrSumm <- as.data.frame(with(ModDat, table(IsolateID,Rep)))
#missing Exps: 01.05.22 (1), 02.04.21 (1), Geranium (2), Navel (2)
OgDat <- ModDat
ModDat <- subset(ModDat, IsolateID != c("01.05.22","02.04.21","Geranium","Navel"))
#run the model
library(lme4); library(car); library(lmerTest)
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|Domest/PlantGeno/IndPlant), data = ModDat)
Sys.time()
sink(file='output/ModelOutputs/BrFullMod_060616.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|Domest/PlantGeno/IndPlant), data = ModDat)")
Sys.time()
rand(fullmod)
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("data/MetaAnalysis/HaMetaDat.csv")
names(ModDat)
HaSumm <- as.data.frame(with(ModDat, table(IsolateID,Exp)))
#missing Exps: 1.05.04 (1), KGB1 (2)
OgDat <- ModDat
#do separately due to error
ModDat <- subset(ModDat, IsolateID != ("1.05.04"))
ModDat <- subset(ModDat, IsolateID != ("KGB1"))
#run the model
library(lme4); library(car); library(lmerTest)
Sys.time()
#working model
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|Domest/PlantGeno/IndPlant), data = ModDat)
Sys.time()
sink(file='output/ModelOutputs/HcFullMod_060716.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|Domest/PlantGeno/IndPlant), data = ModDat)")
Sys.time()
rand(fullmod)
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat), data = ModDat)
Sys.time()
sink(file='output/ModelOutputs/HcFullMod_060716a.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat), data = ModDat)")
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
anova(fullmod)
Sys.time()
sink()
Sys.time()
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Domest/PlantGeno/IndPlant), data = ModDat)
Sys.time()
sink(file='output/ModelOutputs/HcFullMod_060716b.txt')
print("fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) +  (1|Domest/PlantGeno/IndPlant), data = ModDat)")
Sys.time()
rand(fullmod)
Anova(fullmod, type=2)
anova(fullmod)
Sys.time()
sink()
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("data/MetaAnalysis/HaMetaDat.csv")
names(ModDat)
#-------------------------------------------------------------
#check assumptions
#check normality of Scale.LS
require(car)
ModDat$Scale.LS.t <- ModDat$Scale.LS + 1
#not quite normal
qqp(ModDat$Scale.LS.t, "norm")
#---------------------------------------------------------------
#try removing isolates missing from one experiment
HaSumm <- as.data.frame(with(ModDat, table(IsolateID,Exp)))
#missing Exps: 1.05.04 (1), KGB1 (2)
OgDat <- ModDat
#do separately due to error
ModDat <- subset(ModDat, IsolateID != ("1.05.04"))
ModDat <- subset(ModDat, IsolateID != ("KGB1"))
#run the model
library(lme4); library(car); library(lmerTest)
fullmod <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp:IsolateID) + (1|Exp/Domest/PlantGeno), data = ModDat)
fullmod2 <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp:IsolateID) + (1|Exp/Domest/PlantGeno), data = ModDat)
fullmod3 <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp:IsolateID) + (1|Exp/Domest/PlantGeno) + (1|Domest/PlantGeno/IndPlant), data = ModDat)
library(rethinking)
data(rugged)
d <- rugged
d$log_gdp <- log(d$rgdppc_2000)
dd <- d[ complete.cases(d$rgdppc_2000) , ]
#8.3
#old method: fit interaction model
m8.1 <- map(
alist(
log_gdp ~ dnorm( mu , sigma ) ,
mu <- a + bR*rugged + bA*cont_africa + bAR*rugged*cont_africa ,
a ~ dnorm(0,100),
bR ~ dnorm(0,10),
bA ~ dnorm(0,10),
bAR ~ dnorm(0,10),
sigma ~ dunif(0,10)
) ,
data=dd )
precis(m8.1)
dd.trim <- dd[ , c("log_gdp","rugged","cont_africa") ]
str(dd.trim)
require(installr)
updateR()
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("data/MetaAnalysis/HaMetaDat.csv")
names(ModDat)
#-------------------------------------------------------------
#check assumptions
#check normality of Scale.LS
require(car)
ModDat$Scale.LS.t <- ModDat$Scale.LS + 1
#not quite normal
qqp(ModDat$Scale.LS.t, "norm")
#---------------------------------------------------------------
#try removing isolates missing from one experiment
HaSumm <- as.data.frame(with(ModDat, table(IsolateID,Exp)))
#missing Exps: 1.05.04 (1), KGB1 (2)
OgDat <- ModDat
#do separately due to error
ModDat <- subset(ModDat, IsolateID != ("1.05.04"))
ModDat <- subset(ModDat, IsolateID != ("KGB1"))
#run the model
library(lme4); library(car); library(lmerTest)
fullmod3 <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp:IsolateID) + (1|Exp/Domest/PlantGeno) + (1|Domest/PlantGeno/IndPlant), data = ModDat)
fullmod4 <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|Exp:IsolateID) + (1|Exp/Domest/PlantGeno), data = ModDat)
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("data/MetaAnalysis/HaMetaDat.csv")
names(ModDat)
#-------------------------------------------------------------
#check assumptions
#check normality of Scale.LS
require(car)
ModDat$Scale.LS.t <- ModDat$Scale.LS + 1
#not quite normal
qqp(ModDat$Scale.LS.t, "norm")
#---------------------------------------------------------------
#try removing isolates missing from one experiment
HaSumm <- as.data.frame(with(ModDat, table(IsolateID,Exp)))
#missing Exps: 1.05.04 (1), KGB1 (2)
OgDat <- ModDat
#do separately due to error
ModDat <- subset(ModDat, IsolateID != ("1.05.04"))
ModDat <- subset(ModDat, IsolateID != ("KGB1"))
#run the model
library(lme4); library(car); library(lmerTest)
fullmod4 <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|Exp:IsolateID) + (1|Exp/Domest/PlantGeno), data = ModDat)
Sys.time()
sink(file='output/ModelOutputs/HcFullMod_061616.txt')
print("fullmod4 <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) + (1|Exp/Rep) + (1|Exp/Rep/Flat) + (1|Exp:IsolateID) + (1|Exp/Domest/PlantGeno), data = ModDat)")
Sys.time()
rand(fullmod4)
Anova(fullmod4, type=2)
anova(fullmod4)
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("data/MetaAnalysis/HaMetaDat.csv")
names(ModDat)
#-------------------------------------------------------------
#check assumptions
#check normality of Scale.LS
require(car)
ModDat$Scale.LS.t <- ModDat$Scale.LS + 1
#not quite normal
qqp(ModDat$Scale.LS.t, "norm")
#---------------------------------------------------------------
#try removing isolates missing from one experiment
HaSumm <- as.data.frame(with(ModDat, table(IsolateID,Exp)))
#missing Exps: 1.05.04 (1), KGB1 (2)
OgDat <- ModDat
#do separately due to error
ModDat <- subset(ModDat, IsolateID != ("1.05.04"))
ModDat <- subset(ModDat, IsolateID != ("KGB1"))
#run the model
library(lme4); library(car); library(lmerTest)
fullmod5 <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) +  (1|Exp:IsolateID) + (1|Exp:Domest), data = ModDat)
Sys.time()
sink(file='output/ModelOutputs/HcFullMod_061716.txt')
print("fullmod5 <- lmer(Scale.LS ~ IsolateID + Domest/PlantGeno + IsolateID:Domest/PlantGeno + IsolateID:Domest + (1|Exp) +  (1|Exp:IsolateID) + (1|Exp:Domest), data = ModDat)")
Sys.time()
rand(fullmod5)
Anova(fullmod5, type=2)
anova(fullmod5)
Sys.time()
sink()
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/")
#-------------------------------------------------------------
#load data
ModDat <- read.csv("data/MetaAnalysis/HaMetaDat.csv")
names(ModDat)
#-------------------------------------------------------------
#check assumptions
#check normality of Scale.LS
require(car)
ModDat$Scale.LS.t <- ModDat$Scale.LS + 1
#not quite normal
qqp(ModDat$Scale.LS.t, "norm")
#---------------------------------------------------------------
#try removing isolates missing from one experiment
HaSumm <- as.data.frame(with(ModDat, table(IsolateID,Exp)))
#missing Exps: 1.05.04 (1), KGB1 (2)
OgDat <- ModDat
#do separately due to error
ModDat <- subset(ModDat, IsolateID != ("1.05.04"))
ModDat <- subset(ModDat, IsolateID != ("KGB1"))
#run the model
library(lme4); library(car); library(lmerTest)
attach(ModDat)
out <- split( ModDat , f = ModDat$PlantGeno)
head(out[[1]]) #100 elements, max. 69 obs per isolate
read.csv("output/ModelOutputs/HaLSMeans_062016.csv")
phenos <- read.csv("output/ModelOutputs/HaLSMeans_062016.csv")
phenos <- phenos[,c("Estimate", "Plant")]
View(phenos)
phenos <- read.csv("output/ModelOutputs/HaLSMeans_062016.csv")
View(phenos)
phenos <- phenos[,c("IsolateID", "Estimate", "Plant")]
library(tidyr)
phenos_w <- spread(phenos, "Plant", "Estimate")
View(phenos_w)
write.csv(phenos_w, "output/ModelOutputs/HaLSM_forbigRR.csv")
