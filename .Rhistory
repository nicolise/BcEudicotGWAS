geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[6]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH999_", names(HEM.plotdata[6]), sep=""))) +
geom_text(aes(0,get(paste("TH999_", names(HEM.plotdata[6]), sep="")), label =
".999 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=-0.001)
dev.off()
jpeg(paste("plots/MultiPlot/Sp_LesionSize_MAF20_highTR_", names(HEM.plotdata[12]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[12])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[12]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH999_", names(HEM.plotdata[12]), sep=""))) +
geom_text(aes(0,get(paste("TH999_", names(HEM.plotdata[12]), sep="")), label =
".999 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=-0.001)
dev.off()
jpeg(paste("plots/MultiPlot/Sp_LesionSize_MAF20_highTR_", names(HEM.plotdata[14]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[14])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[14]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH999_", names(HEM.plotdata[14]), sep=""))) +
geom_text(aes(0,get(paste("TH999_", names(HEM.plotdata[14]), sep="")), label =
".999 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=-0.001)
dev.off()
jpeg(paste("plots/MultiPlot/Sp_LesionSize_MAF20_highTR_", names(HEM.plotdata[15]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[15])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[15]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH999_", names(HEM.plotdata[15]), sep=""))) +
geom_text(aes(0,get(paste("TH999_", names(HEM.plotdata[15]), sep="")), label =
".999 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=-0.001)
dev.off()
#[15]
jpeg(paste("05_plots/Gm_LesionSize_MAF20_highTR_", names(HEM.plotdata[15]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[15])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[15]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH999_", names(HEM.plotdata[15]), sep=""))) +
geom_text(aes(0,get(paste("TH999_", names(HEM.plotdata[15]), sep="")), label =
".999 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=-0.001)
dev.off()
#}
#stop [15]
jpeg(paste("05_plots/Gm_LesionSize_MAF20_highTR_", names(HEM.plotdata[14]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[14])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[14]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH999_", names(HEM.plotdata[14]), sep=""))) +
geom_text(aes(0,get(paste("TH999_", names(HEM.plotdata[14]), sep="")), label =
".999 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=-0.001)
dev.off()
jpeg(paste("05_plots/Gm_LesionSize_MAF20_highTR_", names(HEM.plotdata[12]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[12])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[12]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH999_", names(HEM.plotdata[12]), sep=""))) +
geom_text(aes(0,get(paste("TH999_", names(HEM.plotdata[12]), sep="")), label =
".999 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=-0.001)
dev.off()
jpeg(paste("05_plots/Gm_LesionSize_MAF20_highTR_", names(HEM.plotdata[5]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[5])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[5]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH999_", names(HEM.plotdata[5]), sep=""))) +
geom_text(aes(0,get(paste("TH999_", names(HEM.plotdata[5]), sep="")), label =
".999 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=-0.001)
dev.off()
jpeg(paste("05_plots/Gm_LesionSize_MAF20_highTR_", names(HEM.plotdata[6]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[6])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[6]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH999_", names(HEM.plotdata[6]), sep=""))) +
geom_text(aes(0,get(paste("TH999_", names(HEM.plotdata[6]), sep="")), label =
".999 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=-0.001)
dev.off()
rm(list=ls())
#setwd("~/Documents/GitRepos/BcSolGWAS/data/SNP_files")
setwd("~/Projects/BcEudicotGWAS/data/RG_files/")
HEMdat <- read.csv("04_bigRRoutput/Gm_Les.OA_HEM.csv")
HEMdat <- read.csv("04_bigRRoutput/Gm_OA.Pheno_HEM.csv")
HEMthresh <- HEMdat[1:4,]
HEMdat <- HEMdat[-c(1:4),]
HEMdat2 <- HEMdat
library(tidyr)
names(HEMdat)
View(HEMdat)
tail(unique(HEMdat$X.1))
HEMdat$X.1 <- gsub(pattern = "Chromosome1\\.", replacement = "Chromosome1.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome2\\.", replacement = "Chromosome2.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome3\\.", replacement = "Chromosome3.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome4\\.", replacement = "Chromosome4.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome5\\.", replacement = "Chromosome5.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome6\\.", replacement = "Chromosome6.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome7\\.", replacement = "Chromosome7.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome8\\.", replacement = "Chromosome8.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome9\\.", replacement = "Chromosome9.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome10\\.", replacement = "Chromosome10.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome11\\.", replacement = "Chromosome11.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome12\\.", replacement = "Chromosome12.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome13\\.", replacement = "Chromosome13.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome14\\.", replacement = "Chromosome14.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome15\\.", replacement = "Chromosome15.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.", replacement = "Chromosome16.0.", HEMdat$X.1)
unique(HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome1\\.0\\.1\\.", replacement = "Chromosome1.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome2\\.0\\.1\\.", replacement = "Chromosome2.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome2\\.0\\.2\\.", replacement = "Chromosome2.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome2\\.0\\.3\\.", replacement = "Chromosome2.3.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome2\\.0\\.4\\.", replacement = "Chromosome2.4.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome2\\.0\\.5\\.", replacement = "Chromosome2.5.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome3\\.0\\.1\\.", replacement = "Chromosome3.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome3\\.0\\.2\\.", replacement = "Chromosome3.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome4\\.0\\.1\\.", replacement = "Chromosome4.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome5\\.0\\.1\\.", replacement = "Chromosome5.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome6\\.0\\.1\\.", replacement = "Chromosome6.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome6\\.0\\.2\\.", replacement = "Chromosome6.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome6\\.0\\.3\\.", replacement = "Chromosome6.3.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome7\\.0\\.1\\.", replacement = "Chromosome7.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome7\\.0\\.2\\.", replacement = "Chromosome7.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome8\\.0\\.1\\.", replacement = "Chromosome8.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome8\\.0\\.2\\.", replacement = "Chromosome8.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome9\\.0\\.1\\.", replacement = "Chromosome9.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome10\\.0\\.1\\.", replacement = "Chromosome10.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome11\\.0\\.1\\.", replacement = "Chromosome11.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome12\\.0\\.1\\.", replacement = "Chromosome12.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome13\\.0\\.1\\.", replacement = "Chromosome13.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome13\\.0\\.2\\.", replacement = "Chromosome13.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome14\\.0\\.1\\.", replacement = "Chromosome14.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome14\\.0\\.2\\.", replacement = "Chromosome14.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome15\\.0\\.1\\.", replacement = "Chromosome15.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome15\\.0\\.2\\.", replacement = "Chromosome15.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome15\\.0\\.3\\.", replacement = "Chromosome15.3.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome15\\.0\\.4\\.", replacement = "Chromosome15.4.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.1\\.", replacement = "Chromosome16.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.2\\.", replacement = "Chromosome16.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.3\\.", replacement = "Chromosome16.3.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.4\\.", replacement = "Chromosome16.4.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.5\\.", replacement = "Chromosome16.5.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.6\\.", replacement = "Chromosome16.6.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.7\\.", replacement = "Chromosome16.7.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.8\\.", replacement = "Chromosome16.8.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.9\\.", replacement = "Chromosome16.9.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.10\\.", replacement = "Chromosome16.10.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.11\\.", replacement = "Chromosome16.11.", HEMdat$X.1)
tail(unique(HEMdat$X.1))
HEMdat2 <- separate (HEMdat, X.1, into = c("Chrom", "Segment", "Pos") )
unique(HEMdat2$Chrom)
unique(HEMdat2$Segment)
write.csv(HEMdat2, "04_bigRRoutput/Gm_OA.Pheno_HEM.PlotFormat.csv")
write.csv(HEMthresh, "04_bigRRoutput/Gm_OA.Pheno_HEM.Thresh.csv")
rm(list=ls())
setwd("~/Documents/GitRepos/BcEudicotGWAS/data/RG_files")
setwd("~/Projects/BcEudicotGWAS/data/RG_files")
library(ggplot2)
library(grid)
HEM.plotdata <- read.csv("04_bigRRoutput/Gm_OA.Pheno_HEM.PlotFormat.csv")
HEM.plotdata$Pos <- as.character(HEM.plotdata$Pos)#ensure that position data is not in scientific notation
HEM.plotdata <- HEM.plotdata[-c(1:2)]
HEM.thresh <- read.csv("04_bigRRoutput/Gm_OA.Pheno_HEM.Thresh.csv")
HEM.thresh <- HEM.thresh[,-c(1:2)]
TH99 <- HEM.thresh[3,]
for (i in 2:ncol(TH99)){
assign(paste("TH99_", names(TH99[i]), sep=""),as.numeric(TH99[i]))
}
TH999 <- HEM.thresh[4,]
for (i in 2:ncol(TH999)){
assign(paste("TH999_", names(TH999[i]), sep=""),as.numeric(TH999[i]))
}
TH95 <- HEM.thresh[1,]
for (i in 2:ncol(TH95)){
assign(paste("TH95_", names(TH95[i]), sep=""),as.numeric(TH95[i]))
}
HEM.plotdata$Chrom <- gsub("Chromosome", "", HEM.plotdata$Chrom)
HEM.plotdata$Chrom <- as.numeric(as.character(HEM.plotdata$Chrom))
HEM.plotdata$Pos <- as.numeric(as.character(HEM.plotdata$Pos))
HEM.plotdata2 <- HEM.plotdata[with(HEM.plotdata, order(Chrom, Pos)), ]
HEM.plotdata$Index = NA
ticks = NULL
lastbase = 0
#want to figure out where to add +500 to draw breaks between chromosomes
#Redo the positions to make them sequential		-- accurate position indexing
for (i in unique(HEM.plotdata$Chrom)) {
print(i)
if (i==1) {
HEM.plotdata[HEM.plotdata$Chrom==i, ]$Index=HEM.plotdata[HEM.plotdata$Chrom==i, ]$Pos
}	else {
#changed lastbase+tail to lastbase+max
lastbase=+lastbase+max(subset(HEM.plotdata,HEM.plotdata$Chrom==i-1)$Pos, 1)
HEM.plotdata[HEM.plotdata$Chrom==i, ]$Index=HEM.plotdata[HEM.plotdata$Chrom==i, ]$Pos+lastbase
}
ticks=c(ticks, HEM.plotdata[HEM.plotdata$Chrom==i, ]$Index[floor(length(HEM.plotdata[HEM.plotdata$Chrom==i, ]$Index)/2)+1])
}
ticklim=c(min(HEM.plotdata$Index),max(HEM.plotdata$Index))
colnames(HEM.plotdata)[16] <- "myIndex"
View(HEM.plotdata)
colnames(HEM.plotdata)[5] <- "myIndex"
jpeg(paste("05_plots/Gm_OA_MAF20_lowTR_", names(HEM.plotdata[4]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[4])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[4]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH95_", names(HEM.plotdata[4]), sep="")), colour = "blue") +
geom_text(aes(0,get(paste("TH95_", names(HEM.plotdata[4]), sep="")), label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")+
geom_hline(yintercept=get(paste("TH99_", names(HEM.plotdata[4]), sep="")), colour = "black") +
geom_text(aes(0,get(paste("TH99_", names(HEM.plotdata[4]), sep="")), label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=0)
dev.off()
rm(list=ls())
setwd("~/PhD/Teaching/Grading")
read.csv("CalculateDist.csv")
mygrades <- read.csv("CalculateDist.csv")
quantile(mygrades)
quantile(mygrades[,1])
quantile(mygrades[,1], probs=seq(.1, .2, .5, .8))
?quantile
quantile(mygrades[,1], probs=seq(0,1,0.25))
quantile(mygrades[,1], probs=seq(0,1,0.1))
setwd("~/Projects/BcEudicotGWAS/data/BcAtGWAS/GWAS_files/05_processing")
setwd("~/Projects/BcEudicotGWAS/data/BcAtGWAS/GWAS_files/05_processing/")
setwd("~/Projects/BcEudicotGWAS/data/BcAtGWAS/GWAS_files/")
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/BcAtGWAS/GWAS_files/05_processing/")
setwd("~/Projects/BcEudicotGWAS/data/BcAtGWAS/05_processing")
HEMdat <- read.csv("BcAtGWAS.HEM.csv")
HEMthresh <- HEMdat[1:4,]
HEMdat <- HEMdat[-c(1:4),]
HEMdat2 <- HEMdat
#RF-Basically it has two columns containing Chrom and pos separately instead of just one column with eg "III.57894". This is easiest to do with code below:
library(tidyr)
names(HEMdat)
#my problem: some are formatted as Chromosome1.252
#others are formatted as Chromosome1.1.252
#this bit does not work
#grx <- glob2rx("Chromosome*.*.*")
#HEMsub <- HEMdat2[grep(grx, HEMdat2$X.1),]
#HEMpractice2 <- HEMpractice
HEMdat2$X.1 <- gsub(pattern = "Chromosome1\\.[0-9]\\.", replacement = "Chromosome1.", HEMdat2$X.1)
HEMdat2$X.1 <- gsub(pattern = "Chromosome2\\.[0-9]\\.", replacement = "Chromosome2.", HEMdat2$X.1)
HEMdat2$X.1 <- gsub(pattern = "Chromosome3\\.[0-9]\\.", replacement = "Chromosome3.", HEMdat2$X.1)
HEMdat2$X.1 <- gsub(pattern = "Chromosome4\\.[0-9]\\.", replacement = "Chromosome4.", HEMdat2$X.1)
HEMdat2$X.1 <- gsub(pattern = "Chromosome5\\.[0-9]\\.", replacement = "Chromosome5.", HEMdat2$X.1)
HEMdat2$X.1 <- gsub(pattern = "Chromosome6\\.[0-9]\\.", replacement = "Chromosome6.", HEMdat2$X.1)
HEMdat2$X.1 <- gsub(pattern = "Chromosome7\\.[0-9]\\.", replacement = "Chromosome7.", HEMdat2$X.1)
HEMdat2$X.1 <- gsub(pattern = "Chromosome8\\.[0-9]\\.", replacement = "Chromosome8.", HEMdat2$X.1)
HEMdat2$X.1 <- gsub(pattern = "Chromosome9\\.[0-9]\\.", replacement = "Chromosome9.", HEMdat2$X.1)
HEMdat2$X.1 <- gsub(pattern = "Chromosome10\\.[0-9]\\.", replacement = "Chromosome10.", HEMdat2$X.1)
HEMdat2$X.1 <- gsub(pattern = "Chromosome11\\.[0-9]\\.", replacement = "Chromosome11.", HEMdat2$X.1)
HEMdat2$X.1 <- gsub(pattern = "Chromosome12\\.[0-9]\\.", replacement = "Chromosome12.", HEMdat2$X.1)
HEMdat2$X.1 <- gsub(pattern = "Chromosome13\\.[0-9]\\.", replacement = "Chromosome13.", HEMdat2$X.1)
HEMdat2$X.1 <- gsub(pattern = "Chromosome14\\.[0-9]\\.", replacement = "Chromosome14.", HEMdat2$X.1)
HEMdat2$X.1 <- gsub(pattern = "Chromosome15\\.[0-9]\\.", replacement = "Chromosome15.", HEMdat2$X.1)
HEMdat2$X.1 <- gsub(pattern = "Chromosome16\\.[0-9]\\.", replacement = "Chromosome16.", HEMdat2$X.1)
HEMdat2$X.1 <- gsub(pattern = "Chromosome16\\.[0-9][0-9]\\.", replacement = "Chromosome16.", HEMdat2$X.1)
HEMdat3 <- separate (HEMdat2, X.1, into = c("Chrom", "Pos") )
#double check
unique(HEMdat3$Chrom)
write.csv(HEMdat3, "At_LesionSize_MAF20.HEM.PlotFormat.csv")
write.csv(HEMthresh, "At_LesionSize_MAF20.HEM.Thresh.csv")
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/BcAtGWAS/05_processing")
library(ggplot2)
library(grid)
HEM.plotdata <- read.csv("At_LesionSize_MAF20.HEM.PlotFormat.csv")
HEM.plotdata$Pos <- as.character(HEM.plotdata$Pos)#ensure that position data is not in scientific notation
HEM.plotdata <- HEM.plotdata[-c(1:2)]
HEM.thresh <- read.csv("At_LesionSize_MAF20.HEM.Thresh.csv")
HEM.thresh <- HEM.thresh[,-c(1:2)]
library(plyr)
library(plyr)
TH99 <- HEM.thresh[3,]
for (i in 2:ncol(TH99)){
assign(paste("TH99_", names(TH99[i]), sep=""),as.numeric(TH99[i]))
}
TH999 <- HEM.thresh[4,]
for (i in 2:ncol(TH999)){
assign(paste("TH999_", names(TH999[i]), sep=""),as.numeric(TH999[i]))
}
TH95 <- HEM.thresh[1,]
for (i in 2:ncol(TH95)){
assign(paste("TH95_", names(TH95[i]), sep=""),as.numeric(TH95[i]))
}
names(HEM.plotdata)
rm(list=ls())
#setwd("~/Documents/GitRepos/BcSolGWAS/data/SNP_files")
setwd("~/Projects/BcEudicotGWAS/data/BcAtGWAS/05_processing")
#Import data
#reorganize file Sl_LesionSize.HEM.csv
HEMdat <- read.csv("BcAtGWAS.HEM.csv")
#first remove first 4 rows (threshold data)
HEMthresh <- HEMdat[1:4,]
HEMdat <- HEMdat[-c(1:4),]
HEMdat2 <- HEMdat
#RF-Basically it has two columns containing Chrom and pos separately instead of just one column with eg "III.57894". This is easiest to do with code below:
library(tidyr)
names(HEMdat)
unique(HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome1\\.", replacement = "Chromosome1.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome2\\.", replacement = "Chromosome2.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome3\\.", replacement = "Chromosome3.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome4\\.", replacement = "Chromosome4.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome5\\.", replacement = "Chromosome5.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome6\\.", replacement = "Chromosome6.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome7\\.", replacement = "Chromosome7.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome8\\.", replacement = "Chromosome8.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome9\\.", replacement = "Chromosome9.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome10\\.", replacement = "Chromosome10.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome11\\.", replacement = "Chromosome11.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome12\\.", replacement = "Chromosome12.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome13\\.", replacement = "Chromosome13.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome14\\.", replacement = "Chromosome14.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome15\\.", replacement = "Chromosome15.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.", replacement = "Chromosome16.0.", HEMdat$X.1)
unique(HEMdat$X.1)
#Then everything with 1.0.(1.)number I'll change to 1.(1.)number
HEMdat$X.1 <- gsub(pattern = "Chromosome1\\.0\\.1\\.", replacement = "Chromosome1.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome2\\.0\\.1\\.", replacement = "Chromosome2.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome2\\.0\\.2\\.", replacement = "Chromosome2.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome2\\.0\\.3\\.", replacement = "Chromosome2.3.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome2\\.0\\.4\\.", replacement = "Chromosome2.4.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome2\\.0\\.5\\.", replacement = "Chromosome2.5.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome3\\.0\\.1\\.", replacement = "Chromosome3.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome3\\.0\\.2\\.", replacement = "Chromosome3.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome4\\.0\\.1\\.", replacement = "Chromosome4.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome5\\.0\\.1\\.", replacement = "Chromosome5.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome6\\.0\\.1\\.", replacement = "Chromosome6.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome6\\.0\\.2\\.", replacement = "Chromosome6.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome6\\.0\\.3\\.", replacement = "Chromosome6.3.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome7\\.0\\.1\\.", replacement = "Chromosome7.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome7\\.0\\.2\\.", replacement = "Chromosome7.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome8\\.0\\.1\\.", replacement = "Chromosome8.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome8\\.0\\.2\\.", replacement = "Chromosome8.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome9\\.0\\.1\\.", replacement = "Chromosome9.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome10\\.0\\.1\\.", replacement = "Chromosome10.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome11\\.0\\.1\\.", replacement = "Chromosome11.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome12\\.0\\.1\\.", replacement = "Chromosome12.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome13\\.0\\.1\\.", replacement = "Chromosome13.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome13\\.0\\.2\\.", replacement = "Chromosome13.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome14\\.0\\.1\\.", replacement = "Chromosome14.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome14\\.0\\.2\\.", replacement = "Chromosome14.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome15\\.0\\.1\\.", replacement = "Chromosome15.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome15\\.0\\.2\\.", replacement = "Chromosome15.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome15\\.0\\.3\\.", replacement = "Chromosome15.3.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome15\\.0\\.4\\.", replacement = "Chromosome15.4.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.1\\.", replacement = "Chromosome16.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.2\\.", replacement = "Chromosome16.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.3\\.", replacement = "Chromosome16.3.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.4\\.", replacement = "Chromosome16.4.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.5\\.", replacement = "Chromosome16.5.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.6\\.", replacement = "Chromosome16.6.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.7\\.", replacement = "Chromosome16.7.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.8\\.", replacement = "Chromosome16.8.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.9\\.", replacement = "Chromosome16.9.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.10\\.", replacement = "Chromosome16.10.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.11\\.", replacement = "Chromosome16.11.", HEMdat$X.1)
HEMdat2 <- separate (HEMdat, X.1, into = c("Chrom", "Segment", "Pos") )
#double check
unique(HEMdat2$Chrom)
unique(HEMdat2$Segment)
write.csv(HEMdat3, "At_LesionSize_MAF20.HEM.PlotFormat.csv")
HEMdat2 <- separate (HEMdat, X.1, into = c("Chrom", "Segment", "Pos") )
unique(HEMdat2$Chrom)
unique(HEMdat2$Segment)
write.csv(HEMdat2, "At_LesionSize_MAF20.HEM.PlotFormat.csv")
write.csv(HEMthresh, "At_LesionSize_MAF20.HEM.Thresh.csv")
rm(list=ls())
setwd("~/Projects/BcEudicotGWAS/data/BcAtGWAS/05_processing")
############################################################################
###Plotting the HEM results
#Load plotting package
library(ggplot2)
library(grid)
#Import data (reorganized from script ReformatBigRRouts.R)
HEM.plotdata <- read.csv("At_LesionSize_MAF20.HEM.PlotFormat.csv")
HEM.plotdata$Pos <- as.character(HEM.plotdata$Pos)#ensure that position data is not in scientific notation
HEM.plotdata <- HEM.plotdata[-c(1:2)]
#get threshhold values
HEM.thresh <- read.csv("At_LesionSize_MAF20.HEM.Thresh.csv")
HEM.thresh <- HEM.thresh[,-c(1:2)]
#take the top 200 over the threshold for each phenotype
library(plyr)
TH99 <- HEM.thresh[3,]
for (i in 2:ncol(TH99)){
assign(paste("TH99_", names(TH99[i]), sep=""),as.numeric(TH99[i]))
}
TH999 <- HEM.thresh[4,]
for (i in 2:ncol(TH999)){
assign(paste("TH999_", names(TH999[i]), sep=""),as.numeric(TH999[i]))
}
TH95 <- HEM.thresh[1,]
for (i in 2:ncol(TH95)){
assign(paste("TH95_", names(TH95[i]), sep=""),as.numeric(TH95[i]))
}
names(HEM.plotdata)
HEM.Col0.Cam <- subset(HEM.plotdata, Col0.Cam > get(paste("TH999_", "Col0.Cam", sep="")),
select=c(Chrom,Segment, Pos,Col0.Cam))
HEM.Col0.Cam <- subset(HEM.plotdata, Col0.Cam > get(paste("TH95_", "Col0.Cam", sep="")),
select=c(Chrom,Segment, Pos,Col0.Cam))
HEM.Col0.Cam <- subset(HEM.plotdata, Col0.Cam > get(paste("TH99_", "Col0.Cam", sep="")),
select=c(Chrom,Segment, Pos,Col0.Cam))
HEM.Col0.Cam <- rename(HEM.Col0.Cam, c("Col0.Cam" = "Effect"))
HEM.Col0.Cam$Pheno <- "Col0.Cam"
HEM.Col0.Cam <- head(arrange(HEM.Col0.Cam,desc(Effect)), n = 200)
names(HEM.plotdata)
HEM.Col0.Cam <- subset(HEM.plotdata, select=c(Chrom,Segment, Pos,Col0.Cam))
HEM.Col0.Cam <- rename(HEM.Col0.Cam, c("Col0.Cam" = "Effect"))
HEM.Col0.Cam$Pheno <- "Col0.Cam"
HEM.Col0.Cam <- head(arrange(HEM.Col0.Cam,desc(Effect)), n = 200)
names(HEM.plotdata)
#Col0.Cam: 0.99
HEM.Col0.Cam <- subset(HEM.plotdata, Col0.Cam > get(paste("TH99_", "Col0.Cam", sep="")),
select=c(Chrom,Segment, Pos,Col0.Cam))
HEM.Col0.Cam <- rename(HEM.Col0.Cam, c("Col0.Cam" = "Effect"))
HEM.Col0.Cam$Pheno <- "Col0.Cam"
HEM.Col0.Cam <- head(arrange(HEM.Col0.Cam,desc(Effect)), n = 200)
#but for now just the top 200 SNPs for each
#Col0.Cam
HEM.Col0.Cam <- subset(HEM.plotdata, select=c(Chrom,Segment, Pos,Col0.Cam))
HEM.Col0.Cam <- rename(HEM.Col0.Cam, c("Col0.Cam" = "Effect"))
HEM.Col0.Cam$Pheno <- "Col0.Cam"
HEM.Col0.Cam <- head(arrange(HEM.Col0.Cam,desc(Effect)), n = 200)
#Col0.AT3G26830
HEM.Col0.AT3G26830 <- subset(HEM.plotdata, select=c(Chrom,Segment, Pos,Col0.AT3G26830))
HEM.Col0.AT3G26830 <- rename(HEM.Col0.AT3G26830, c("Col0.AT3G26830" = "Effect"))
HEM.Col0.AT3G26830$Pheno <- "Col0.AT3G26830"
HEM.Col0.AT3G26830 <- head(arrange(HEM.Col0.AT3G26830,desc(Effect)), n = 200)
#Col.0AT4G30530
HEM.Col.0AT4G30530 <- subset(HEM.plotdata, select=c(Chrom,Segment, Pos,Col.0AT4G30530))
HEM.Col.0AT4G30530 <- rename(HEM.Col.0AT4G30530, c("Col.0AT4G30530" = "Effect"))
HEM.Col.0AT4G30530$Pheno <- "Col.0AT4G30530"
HEM.Col.0AT4G30530 <- head(arrange(HEM.Col.0AT4G30530,desc(Effect)), n = 200)
#anac055.Cam
HEM.anac055.Cam <- subset(HEM.plotdata, select=c(Chrom,Segment, Pos,anac055.Cam))
HEM.anac055.Cam <- rename(HEM.anac055.Cam, c("anac055.Cam" = "Effect"))
HEM.anac055.Cam$Pheno <- "anac055.Cam"
HEM.anac055.Cam <- head(arrange(HEM.anac055.Cam,desc(Effect)), n = 200)
#anac055.Les.s
HEM.anac055.Les.s <- subset(HEM.plotdata, select=c(Chrom,Segment, Pos,anac055.Les.s))
HEM.anac055.Les.s <- rename(HEM.anac055.Les.s, c("anac055.Les.s" = "Effect"))
HEM.anac055.Les.s$Pheno <- "anac055.Les.s"
HEM.anac055.Les.s <- head(arrange(HEM.anac055.Les.s,desc(Effect)), n = 200)
#coi1.Cam
HEM.coi1.Cam <- subset(HEM.plotdata, select=c(Chrom,Segment, Pos,coi1.Cam))
HEM.coi1.Cam <- rename(HEM.coi1.Cam, c("coi1.Cam" = "Effect"))
HEM.coi1.Cam$Pheno <- "coi1.Cam"
HEM.coi1.Cam <- head(arrange(HEM.coi1.Cam,desc(Effect)), n = 200)
#coi1.Les.s
HEM.coi1.Les.s <- subset(HEM.plotdata, select=c(Chrom,Segment, Pos,coi1.Les.s))
HEM.coi1.Les.s <- rename(HEM.coi1.Les.s, c("coi1.Les.s" = "Effect"))
HEM.coi1.Les.s$Pheno <- "coi1.Les.s"
HEM.coi1.Les.s <- head(arrange(HEM.coi1.Les.s,desc(Effect)), n = 200)
#npr1.Cam
HEM.npr1.Cam <- subset(HEM.plotdata, select=c(Chrom,Segment, Pos,npr1.Cam))
HEM.npr1.Cam <- rename(HEM.npr1.Cam, c("npr1.Cam" = "Effect"))
HEM.npr1.Cam$Pheno <- "npr1.Cam"
HEM.npr1.Cam <- head(arrange(HEM.npr1.Cam,desc(Effect)), n = 200)
#npr1.Les.s
HEM.npr1.Les.s <- subset(HEM.plotdata, select=c(Chrom,Segment, Pos,npr1.Les.s))
HEM.npr1.Les.s <- rename(HEM.npr1.Les.s, c("npr1.Les.s" = "Effect"))
HEM.npr1.Les.s$Pheno <- "npr1.Les.s"
HEM.npr1.Les.s <- head(arrange(HEM.npr1.Les.s,desc(Effect)), n = 200)
#tga3.Cam
HEM.tga3.Cam <- subset(HEM.plotdata, select=c(Chrom,Segment, Pos,tga3.Cam))
HEM.tga3.Cam <- rename(HEM.tga3.Cam, c("tga3.Cam" = "Effect"))
HEM.tga3.Cam$Pheno <- "tga3.Cam"
HEM.tga3.Cam <- head(arrange(HEM.tga3.Cam,desc(Effect)), n = 200)
#tga3.Les.s
HEM.tga3.Les.s <- subset(HEM.plotdata, select=c(Chrom,Segment, Pos,tga3.Les.s))
HEM.tga3.Les.s <- rename(HEM.tga3.Les.s, c("tga3.Les.s" = "Effect"))
HEM.tga3.Les.s$Pheno <- "tga3.Les.s"
HEM.tga3.Les.s <- head(arrange(HEM.tga3.Les.s,desc(Effect)), n = 200)
names(HEM.plotdata)
HEM.Col0.AT4G30530 <- subset(HEM.plotdata, select=c(Chrom,Segment, Pos,Col.0AT4G30530))
HEM.Col0.AT4G30530 <- rename(HEM.Col0.AT4G30530, c("Col.0AT4G30530" = "Effect"))
HEM.Col0.AT4G30530$Pheno <- "Col0.AT4G30530"
HEM.Col0.AT4G30530 <- head(arrange(HEM.Col0.AT4G30530,desc(Effect)), n = 200)
names(HEM.plotdata)
HEM.Col0.Les.s <- subset(HEM.plotdata, select=c(Chrom,Segment, Pos,Col0.Les.s))
HEM.Col0.Les.s <- rename(HEM.Col0.Les.s, c("Col0.Les.s" = "Effect"))
HEM.Col0.Les.s$Pheno <- "Col0.Les.s"
HEM.Col0.Les.s <- head(arrange(HEM.Col0.Les.s,desc(Effect)), n = 200)
names(HEM.plotdata)
Top200SNP <- rbind(HEM.tga3.Cam, HEM.tga3.Les.s, HEM.npr1.Les.s, HEM.npr1.Cam, HEM.coi1.Les.s, HEM.coi1.Cam, HEM.anac055.Les.s, HEM.anac055.Cam, HEM.Col0.AT4G30530, HEM.Col0.AT3G26830, HEM.Col0.Cam, HEM.Col0.Les.s)
Top200SNP$Chrom <- gsub("Chromosome", "", Top50SNP$Chrom)
Top200SNP$Chrom <- gsub("Chromosome", "", Top200SNP$Chrom)
Top200SNP$Chrom <- as.numeric(as.character(Top200SNP$Chrom))
Top200SNP$Pos <- as.numeric(as.character(Top200SNP$Pos))
write.csv(Top200SNP, "Top200SNPs_BcAtGWAS.csv")
