geom_hline(yintercept=get(paste("TH95_", names(HEM.plotdata[y]), sep="")), colour = "blue") +
geom_text(aes(0,get(paste("TH95_", names(HEM.plotdata[y]), sep="")), label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")+
geom_hline(yintercept=get(paste("TH99_", names(HEM.plotdata[y]), sep="")), colour = "black") +
geom_text(aes(0,get(paste("TH99_", names(HEM.plotdata[y]), sep="")), label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=0)
dev.off()
}
for (y in 4){ #[y]
jpeg(paste("05_plots/Gm_LesionSize_MAF20_lowTR_", names(HEM.plotdata[y]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[y])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[y]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH95_", names(HEM.plotdata[y]), sep="")), colour = "blue") +
geom_text(aes(0,get(paste("TH95_", names(HEM.plotdata[y]), sep="")), label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")+
geom_hline(yintercept=get(paste("TH99_", names(HEM.plotdata[y]), sep="")), colour = "black") +
geom_text(aes(0,get(paste("TH99_", names(HEM.plotdata[y]), sep="")), label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=0)
dev.off()
}
for (y in 4){ #[y]
jpeg(paste("05_plots/Gm_LesionSize_MAF20_lowTR_", names(HEM.plotdata[y]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[y])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[y]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH95_", names(HEM.plotdata[y]), sep="")), colour = "blue") +
geom_text(aes(0,get(paste("TH95_", names(HEM.plotdata[y]), sep="")), label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")+
geom_hline(yintercept=get(paste("TH99_", names(HEM.plotdata[y]), sep="")), colour = "black") +
geom_text(aes(0,get(paste("TH99_", names(HEM.plotdata[y]), sep="")), label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=0)
dev.off()
}
for (m in 4){ #[y]
jpeg(paste("05_plots/Gm_LesionSize_MAF20_lowTR_", names(HEM.plotdata[m]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[m])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[m]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH95_", names(HEM.plotdata[m]), sep="")), colour = "blue") +
geom_text(aes(0,get(paste("TH95_", names(HEM.plotdata[m]), sep="")), label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")+
geom_hline(yintercept=get(paste("TH99_", names(HEM.plotdata[m]), sep="")), colour = "black") +
geom_text(aes(0,get(paste("TH99_", names(HEM.plotdata[m]), sep="")), label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=0)
dev.off()
}
for (m in 4){ #[m]
jpeg(paste("05_plots/Gm_LesionSize_MAF20_lowTR_", names(HEM.plotdata[m]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[m])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))
dev.off
}
dev.off
for (m in 4){ #[m]
#jpeg(paste("05_plots/Gm_LesionSize_MAF20_lowTR_", names(HEM.plotdata[m]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[m])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))
#  dev.off
}
jpeg(paste("05_plots/Gm_LesionSize_MAF20_lowTR_", names(HEM.plotdata[4]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[4])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[4]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH95_", names(HEM.plotdata[4]), sep="")), colour = "blue") +
geom_text(aes(0,get(paste("TH95_", names(HEM.plotdata[4]), sep="")), label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")+
geom_hline(yintercept=get(paste("TH99_", names(HEM.plotdata[4]), sep="")), colour = "black") +
geom_text(aes(0,get(paste("TH99_", names(HEM.plotdata[4]), sep="")), label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=0)
dev.off()
}
rm(list=ls())
setwd("~/Documents/GitRepos/BcEudicotGWAS/data/RG_files")
setwd("~/Projects/BcEudicotGWAS/data/RG_files")
############################################################################
###Plotting the HEM results
#Load plotting package
library(ggplot2)
library(grid)
#Import data (reorganized from script ReformatBigRRouts.R)
HEM.plotdata <- read.csv("04_bigRRoutput/Gm_Les.Pheno_HEM.PlotFormat.csv")
HEM.plotdata$Pos <- as.character(HEM.plotdata$Pos)#ensure that position data is not in scientific notation
HEM.plotdata <- HEM.plotdata[-c(1:2)]
#get threshhold values
HEM.thresh <- read.csv("04_bigRRoutput/Gm_Les.Pheno_HEM.Thresh.csv")
HEM.thresh <- HEM.thresh[,-c(1:2)]
TH99 <- HEM.thresh[3,]
for (i in 2:ncol(TH99)){
assign(paste("TH99_", names(TH99[i]), sep=""),as.numeric(TH99[i]))
}
TH999 <- HEM.thresh[4,]
for (i in 2:ncol(TH999)){
assign(paste("TH999_", names(TH999[i]), sep=""),as.numeric(TH999[i]))
}
TH95 <- HEM.thresh[1,]
for (i in 2:ncol(TH95)){
assign(paste("TH95_", names(TH95[i]), sep=""),as.numeric(TH95[i]))
}
# #Reformat Chromosomes and Positions
HEM.plotdata$Chrom <- gsub("Chromosome", "", HEM.plotdata$Chrom)
HEM.plotdata$Chrom <- as.numeric(as.character(HEM.plotdata$Chrom))
HEM.plotdata$Pos <- as.numeric(as.character(HEM.plotdata$Pos))
#sort dataframe rows in order of Chrom, then Pos
HEM.plotdata2 <- HEM.plotdata[with(HEM.plotdata, order(Chrom, Pos)), ]
#Make plotting variables
HEM.plotdata$Index = NA
ticks = NULL
lastbase = 0
#want to figure out where to add +500 to draw breaks between chromosomes
#Redo the positions to make them sequential		-- accurate position indexing
for (i in unique(HEM.plotdata$Chrom)) {
print(i)
if (i==1) {
HEM.plotdata[HEM.plotdata$Chrom==i, ]$Index=HEM.plotdata[HEM.plotdata$Chrom==i, ]$Pos
}	else {
#changed lastbase+tail to lastbase+max
lastbase=+lastbase+max(subset(HEM.plotdata,HEM.plotdata$Chrom==i-1)$Pos, 1)
HEM.plotdata[HEM.plotdata$Chrom==i, ]$Index=HEM.plotdata[HEM.plotdata$Chrom==i, ]$Pos+lastbase
}
ticks=c(ticks, HEM.plotdata[HEM.plotdata$Chrom==i, ]$Index[floor(length(HEM.plotdata[HEM.plotdata$Chrom==i, ]$Index)/2)+1])
}
ticklim=c(min(HEM.plotdata$Index),max(HEM.plotdata$Index))
colnames(HEM.plotdata)[16] <- "myIndex"
#make plots for each phenotype
#it isn't working with the loop for some reason
#for (m in 4:15){ #[5]
jpeg(paste("05_plots/Gm_LesionSize_MAF20_lowTR_", names(HEM.plotdata[5]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[5])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[5]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH95_", names(HEM.plotdata[5]), sep="")), colour = "blue") +
geom_text(aes(0,get(paste("TH95_", names(HEM.plotdata[5]), sep="")), label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")+
geom_hline(yintercept=get(paste("TH99_", names(HEM.plotdata[5]), sep="")), colour = "black") +
geom_text(aes(0,get(paste("TH99_", names(HEM.plotdata[5]), sep="")), label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=0)
dev.off()
jpeg(paste("05_plots/Gm_LesionSize_MAF20_lowTR_", names(HEM.plotdata[4]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[4])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[4]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH95_", names(HEM.plotdata[4]), sep="")), colour = "blue") +
geom_text(aes(0,get(paste("TH95_", names(HEM.plotdata[4]), sep="")), label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")+
geom_hline(yintercept=get(paste("TH99_", names(HEM.plotdata[4]), sep="")), colour = "black") +
geom_text(aes(0,get(paste("TH99_", names(HEM.plotdata[4]), sep="")), label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=0)
dev.off()
#}
jpeg(paste("05_plots/Gm_LesionSize_MAF20_lowTR_", names(HEM.plotdata[6]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[6])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[6]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH95_", names(HEM.plotdata[6]), sep="")), colour = "blue") +
geom_text(aes(0,get(paste("TH95_", names(HEM.plotdata[6]), sep="")), label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")+
geom_hline(yintercept=get(paste("TH99_", names(HEM.plotdata[6]), sep="")), colour = "black") +
geom_text(aes(0,get(paste("TH99_", names(HEM.plotdata[6]), sep="")), label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=0)
dev.off()
jpeg(paste("05_plots/Gm_LesionSize_MAF20_lowTR_", names(HEM.plotdata[7]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[7])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[7]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH95_", names(HEM.plotdata[7]), sep="")), colour = "blue") +
geom_text(aes(0,get(paste("TH95_", names(HEM.plotdata[7]), sep="")), label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")+
geom_hline(yintercept=get(paste("TH99_", names(HEM.plotdata[7]), sep="")), colour = "black") +
geom_text(aes(0,get(paste("TH99_", names(HEM.plotdata[7]), sep="")), label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=0)
dev.off()
jpeg(paste("05_plots/Gm_LesionSize_MAF20_lowTR_", names(HEM.plotdata[8]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[8])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[8]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH95_", names(HEM.plotdata[8]), sep="")), colour = "blue") +
geom_text(aes(0,get(paste("TH95_", names(HEM.plotdata[8]), sep="")), label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")+
geom_hline(yintercept=get(paste("TH99_", names(HEM.plotdata[8]), sep="")), colour = "black") +
geom_text(aes(0,get(paste("TH99_", names(HEM.plotdata[8]), sep="")), label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=0)
dev.off()
jpeg(paste("05_plots/Gm_LesionSize_MAF20_lowTR_", names(HEM.plotdata[9]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[9])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[9]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH95_", names(HEM.plotdata[9]), sep="")), colour = "blue") +
geom_text(aes(0,get(paste("TH95_", names(HEM.plotdata[9]), sep="")), label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")+
geom_hline(yintercept=get(paste("TH99_", names(HEM.plotdata[9]), sep="")), colour = "black") +
geom_text(aes(0,get(paste("TH99_", names(HEM.plotdata[9]), sep="")), label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=0)
dev.off()
jpeg(paste("05_plots/Gm_LesionSize_MAF20_lowTR_", names(HEM.plotdata[10]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[10])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[10]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH95_", names(HEM.plotdata[10]), sep="")), colour = "blue") +
geom_text(aes(0,get(paste("TH95_", names(HEM.plotdata[10]), sep="")), label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")+
geom_hline(yintercept=get(paste("TH99_", names(HEM.plotdata[10]), sep="")), colour = "black") +
geom_text(aes(0,get(paste("TH99_", names(HEM.plotdata[10]), sep="")), label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=0)
dev.off()
jpeg(paste("05_plots/Gm_LesionSize_MAF20_lowTR_", names(HEM.plotdata[12]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[12])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[12]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH95_", names(HEM.plotdata[12]), sep="")), colour = "blue") +
geom_text(aes(0,get(paste("TH95_", names(HEM.plotdata[12]), sep="")), label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")+
geom_hline(yintercept=get(paste("TH99_", names(HEM.plotdata[12]), sep="")), colour = "black") +
geom_text(aes(0,get(paste("TH99_", names(HEM.plotdata[12]), sep="")), label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=0)
dev.off()
jpeg(paste("05_plots/Gm_LesionSize_MAF20_lowTR_", names(HEM.plotdata[13]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[13])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[13]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH95_", names(HEM.plotdata[13]), sep="")), colour = "blue") +
geom_text(aes(0,get(paste("TH95_", names(HEM.plotdata[13]), sep="")), label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")+
geom_hline(yintercept=get(paste("TH99_", names(HEM.plotdata[13]), sep="")), colour = "black") +
geom_text(aes(0,get(paste("TH99_", names(HEM.plotdata[13]), sep="")), label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=0)
dev.off()
jpeg(paste("05_plots/Gm_LesionSize_MAF20_lowTR_", names(HEM.plotdata[14]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[14])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[14]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH95_", names(HEM.plotdata[14]), sep="")), colour = "blue") +
geom_text(aes(0,get(paste("TH95_", names(HEM.plotdata[14]), sep="")), label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")+
geom_hline(yintercept=get(paste("TH99_", names(HEM.plotdata[14]), sep="")), colour = "black") +
geom_text(aes(0,get(paste("TH99_", names(HEM.plotdata[14]), sep="")), label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=0)
dev.off()
jpeg(paste("05_plots/Gm_LesionSize_MAF20_lowTR_", names(HEM.plotdata[15]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[15])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[15]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH95_", names(HEM.plotdata[15]), sep="")), colour = "blue") +
geom_text(aes(0,get(paste("TH95_", names(HEM.plotdata[15]), sep="")), label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")+
geom_hline(yintercept=get(paste("TH99_", names(HEM.plotdata[15]), sep="")), colour = "black") +
geom_text(aes(0,get(paste("TH99_", names(HEM.plotdata[15]), sep="")), label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=0)
dev.off()
View(HEM.plotdata)
jpeg(paste("plots/MultiPlot/Sp_LesionSize_MAF20_highTR_", names(HEM.plotdata[5]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[5])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[5]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH999_", names(HEM.plotdata[5]), sep=""))) +
geom_text(aes(0,get(paste("TH999_", names(HEM.plotdata[5]), sep="")), label =
".999 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=-0.001)
dev.off()
jpeg(paste("plots/MultiPlot/Sp_LesionSize_MAF20_highTR_", names(HEM.plotdata[6]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[6])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[6]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH999_", names(HEM.plotdata[6]), sep=""))) +
geom_text(aes(0,get(paste("TH999_", names(HEM.plotdata[6]), sep="")), label =
".999 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=-0.001)
dev.off()
jpeg(paste("plots/MultiPlot/Sp_LesionSize_MAF20_highTR_", names(HEM.plotdata[12]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[12])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[12]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH999_", names(HEM.plotdata[12]), sep=""))) +
geom_text(aes(0,get(paste("TH999_", names(HEM.plotdata[12]), sep="")), label =
".999 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=-0.001)
dev.off()
jpeg(paste("plots/MultiPlot/Sp_LesionSize_MAF20_highTR_", names(HEM.plotdata[14]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[14])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[14]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH999_", names(HEM.plotdata[14]), sep=""))) +
geom_text(aes(0,get(paste("TH999_", names(HEM.plotdata[14]), sep="")), label =
".999 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=-0.001)
dev.off()
jpeg(paste("plots/MultiPlot/Sp_LesionSize_MAF20_highTR_", names(HEM.plotdata[15]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[15])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[15]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH999_", names(HEM.plotdata[15]), sep=""))) +
geom_text(aes(0,get(paste("TH999_", names(HEM.plotdata[15]), sep="")), label =
".999 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=-0.001)
dev.off()
#[15]
jpeg(paste("05_plots/Gm_LesionSize_MAF20_highTR_", names(HEM.plotdata[15]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[15])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[15]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH999_", names(HEM.plotdata[15]), sep=""))) +
geom_text(aes(0,get(paste("TH999_", names(HEM.plotdata[15]), sep="")), label =
".999 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=-0.001)
dev.off()
#}
#stop [15]
jpeg(paste("05_plots/Gm_LesionSize_MAF20_highTR_", names(HEM.plotdata[14]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[14])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[14]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH999_", names(HEM.plotdata[14]), sep=""))) +
geom_text(aes(0,get(paste("TH999_", names(HEM.plotdata[14]), sep="")), label =
".999 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=-0.001)
dev.off()
jpeg(paste("05_plots/Gm_LesionSize_MAF20_highTR_", names(HEM.plotdata[12]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[12])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[12]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH999_", names(HEM.plotdata[12]), sep=""))) +
geom_text(aes(0,get(paste("TH999_", names(HEM.plotdata[12]), sep="")), label =
".999 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=-0.001)
dev.off()
jpeg(paste("05_plots/Gm_LesionSize_MAF20_highTR_", names(HEM.plotdata[5]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[5])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[5]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH999_", names(HEM.plotdata[5]), sep=""))) +
geom_text(aes(0,get(paste("TH999_", names(HEM.plotdata[5]), sep="")), label =
".999 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=-0.001)
dev.off()
jpeg(paste("05_plots/Gm_LesionSize_MAF20_highTR_", names(HEM.plotdata[6]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[6])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[6]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH999_", names(HEM.plotdata[6]), sep=""))) +
geom_text(aes(0,get(paste("TH999_", names(HEM.plotdata[6]), sep="")), label =
".999 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=-0.001)
dev.off()
rm(list=ls())
#setwd("~/Documents/GitRepos/BcSolGWAS/data/SNP_files")
setwd("~/Projects/BcEudicotGWAS/data/RG_files/")
HEMdat <- read.csv("04_bigRRoutput/Gm_Les.OA_HEM.csv")
HEMdat <- read.csv("04_bigRRoutput/Gm_OA.Pheno_HEM.csv")
HEMthresh <- HEMdat[1:4,]
HEMdat <- HEMdat[-c(1:4),]
HEMdat2 <- HEMdat
library(tidyr)
names(HEMdat)
View(HEMdat)
tail(unique(HEMdat$X.1))
HEMdat$X.1 <- gsub(pattern = "Chromosome1\\.", replacement = "Chromosome1.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome2\\.", replacement = "Chromosome2.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome3\\.", replacement = "Chromosome3.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome4\\.", replacement = "Chromosome4.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome5\\.", replacement = "Chromosome5.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome6\\.", replacement = "Chromosome6.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome7\\.", replacement = "Chromosome7.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome8\\.", replacement = "Chromosome8.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome9\\.", replacement = "Chromosome9.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome10\\.", replacement = "Chromosome10.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome11\\.", replacement = "Chromosome11.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome12\\.", replacement = "Chromosome12.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome13\\.", replacement = "Chromosome13.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome14\\.", replacement = "Chromosome14.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome15\\.", replacement = "Chromosome15.0.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.", replacement = "Chromosome16.0.", HEMdat$X.1)
unique(HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome1\\.0\\.1\\.", replacement = "Chromosome1.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome2\\.0\\.1\\.", replacement = "Chromosome2.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome2\\.0\\.2\\.", replacement = "Chromosome2.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome2\\.0\\.3\\.", replacement = "Chromosome2.3.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome2\\.0\\.4\\.", replacement = "Chromosome2.4.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome2\\.0\\.5\\.", replacement = "Chromosome2.5.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome3\\.0\\.1\\.", replacement = "Chromosome3.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome3\\.0\\.2\\.", replacement = "Chromosome3.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome4\\.0\\.1\\.", replacement = "Chromosome4.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome5\\.0\\.1\\.", replacement = "Chromosome5.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome6\\.0\\.1\\.", replacement = "Chromosome6.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome6\\.0\\.2\\.", replacement = "Chromosome6.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome6\\.0\\.3\\.", replacement = "Chromosome6.3.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome7\\.0\\.1\\.", replacement = "Chromosome7.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome7\\.0\\.2\\.", replacement = "Chromosome7.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome8\\.0\\.1\\.", replacement = "Chromosome8.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome8\\.0\\.2\\.", replacement = "Chromosome8.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome9\\.0\\.1\\.", replacement = "Chromosome9.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome10\\.0\\.1\\.", replacement = "Chromosome10.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome11\\.0\\.1\\.", replacement = "Chromosome11.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome12\\.0\\.1\\.", replacement = "Chromosome12.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome13\\.0\\.1\\.", replacement = "Chromosome13.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome13\\.0\\.2\\.", replacement = "Chromosome13.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome14\\.0\\.1\\.", replacement = "Chromosome14.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome14\\.0\\.2\\.", replacement = "Chromosome14.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome15\\.0\\.1\\.", replacement = "Chromosome15.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome15\\.0\\.2\\.", replacement = "Chromosome15.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome15\\.0\\.3\\.", replacement = "Chromosome15.3.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome15\\.0\\.4\\.", replacement = "Chromosome15.4.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.1\\.", replacement = "Chromosome16.1.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.2\\.", replacement = "Chromosome16.2.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.3\\.", replacement = "Chromosome16.3.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.4\\.", replacement = "Chromosome16.4.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.5\\.", replacement = "Chromosome16.5.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.6\\.", replacement = "Chromosome16.6.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.7\\.", replacement = "Chromosome16.7.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.8\\.", replacement = "Chromosome16.8.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.9\\.", replacement = "Chromosome16.9.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.10\\.", replacement = "Chromosome16.10.", HEMdat$X.1)
HEMdat$X.1 <- gsub(pattern = "Chromosome16\\.0\\.11\\.", replacement = "Chromosome16.11.", HEMdat$X.1)
tail(unique(HEMdat$X.1))
HEMdat2 <- separate (HEMdat, X.1, into = c("Chrom", "Segment", "Pos") )
unique(HEMdat2$Chrom)
unique(HEMdat2$Segment)
write.csv(HEMdat2, "04_bigRRoutput/Gm_OA.Pheno_HEM.PlotFormat.csv")
write.csv(HEMthresh, "04_bigRRoutput/Gm_OA.Pheno_HEM.Thresh.csv")
rm(list=ls())
setwd("~/Documents/GitRepos/BcEudicotGWAS/data/RG_files")
setwd("~/Projects/BcEudicotGWAS/data/RG_files")
library(ggplot2)
library(grid)
HEM.plotdata <- read.csv("04_bigRRoutput/Gm_OA.Pheno_HEM.PlotFormat.csv")
HEM.plotdata$Pos <- as.character(HEM.plotdata$Pos)#ensure that position data is not in scientific notation
HEM.plotdata <- HEM.plotdata[-c(1:2)]
HEM.thresh <- read.csv("04_bigRRoutput/Gm_OA.Pheno_HEM.Thresh.csv")
HEM.thresh <- HEM.thresh[,-c(1:2)]
TH99 <- HEM.thresh[3,]
for (i in 2:ncol(TH99)){
assign(paste("TH99_", names(TH99[i]), sep=""),as.numeric(TH99[i]))
}
TH999 <- HEM.thresh[4,]
for (i in 2:ncol(TH999)){
assign(paste("TH999_", names(TH999[i]), sep=""),as.numeric(TH999[i]))
}
TH95 <- HEM.thresh[1,]
for (i in 2:ncol(TH95)){
assign(paste("TH95_", names(TH95[i]), sep=""),as.numeric(TH95[i]))
}
HEM.plotdata$Chrom <- gsub("Chromosome", "", HEM.plotdata$Chrom)
HEM.plotdata$Chrom <- as.numeric(as.character(HEM.plotdata$Chrom))
HEM.plotdata$Pos <- as.numeric(as.character(HEM.plotdata$Pos))
HEM.plotdata2 <- HEM.plotdata[with(HEM.plotdata, order(Chrom, Pos)), ]
HEM.plotdata$Index = NA
ticks = NULL
lastbase = 0
#want to figure out where to add +500 to draw breaks between chromosomes
#Redo the positions to make them sequential		-- accurate position indexing
for (i in unique(HEM.plotdata$Chrom)) {
print(i)
if (i==1) {
HEM.plotdata[HEM.plotdata$Chrom==i, ]$Index=HEM.plotdata[HEM.plotdata$Chrom==i, ]$Pos
}	else {
#changed lastbase+tail to lastbase+max
lastbase=+lastbase+max(subset(HEM.plotdata,HEM.plotdata$Chrom==i-1)$Pos, 1)
HEM.plotdata[HEM.plotdata$Chrom==i, ]$Index=HEM.plotdata[HEM.plotdata$Chrom==i, ]$Pos+lastbase
}
ticks=c(ticks, HEM.plotdata[HEM.plotdata$Chrom==i, ]$Index[floor(length(HEM.plotdata[HEM.plotdata$Chrom==i, ]$Index)/2)+1])
}
ticklim=c(min(HEM.plotdata$Index),max(HEM.plotdata$Index))
colnames(HEM.plotdata)[16] <- "myIndex"
View(HEM.plotdata)
colnames(HEM.plotdata)[5] <- "myIndex"
jpeg(paste("05_plots/Gm_OA_MAF20_lowTR_", names(HEM.plotdata[4]), ".ManhattanPlot.jpg", sep=""), width=8, height=4, units='in', res=600)
ggplot(HEM.plotdata, aes(x=myIndex, y=abs(HEM.plotdata[4])))+
theme_bw()+
geom_point(aes(color = factor(Chrom)))+
labs(list(y="SNP Effect Estimate", x="Chromosome position", title=paste("Lesion Size on ", names(HEM.plotdata[4]))))+
guides(col = guide_legend(nrow = 8, title="Chromosome"))+
geom_hline(yintercept=get(paste("TH95_", names(HEM.plotdata[4]), sep="")), colour = "blue") +
geom_text(aes(0,get(paste("TH95_", names(HEM.plotdata[4]), sep="")), label = ".95 Threshold", vjust = 1.5, hjust = .05), col = "blue")+
geom_hline(yintercept=get(paste("TH99_", names(HEM.plotdata[4]), sep="")), colour = "black") +
geom_text(aes(0,get(paste("TH99_", names(HEM.plotdata[4]), sep="")), label = ".99 Threshold", vjust = 1.5, hjust = .05), col = "black")+
expand_limits(y=0)
dev.off()
